/*
* FooTable v3 - FooTable is a jQuery plugin that aims to make HTML tables on smaller devices look awesome.
* @version 3.1.5
* @link http://fooplugins.com
* @copyright Steven Usher & Brad Vincent 2015
* @license Released under the GPLv3 license.
*/
(function($,F){window.console=window.console||{log:function(){},error:function(){}};$.fn.footable=function(options,ready){options=options||{};return this.filter('table').each(function(i,tbl){F.init(tbl,options,ready)})};var debug_defaults={events:[]};F.__debug__=JSON.parse(localStorage.getItem('footable_debug'))||!1;F.__debug_options__=JSON.parse(localStorage.getItem('footable_debug_options'))||debug_defaults;F.debug=function(value,options){if(!F.is.boolean(value))return F.__debug__;F.__debug__=value;if(F.__debug__){localStorage.setItem('footable_debug',JSON.stringify(F.__debug__));F.__debug_options__=$.extend(!0,{},debug_defaults,options||{});if(F.is.hash(options)){localStorage.setItem('footable_debug_options',JSON.stringify(F.__debug_options__))}}else{localStorage.removeItem('footable_debug');localStorage.removeItem('footable_debug_options')}};F.get=function(table){return $(table).first().data('__FooTable__')};F.init=function(table,options,ready){var ft=F.get(table);if(ft instanceof F.Table)ft.destroy();return new F.Table(table,options,ready)};F.getRow=function(element){var $row=$(element).closest('tr');if($row.hasClass('footable-detail-row')){$row=$row.prev()}
return $row.data('__FooTableRow__')}})(jQuery,FooTable=window.FooTable||{});(function(F){var returnTrue=function(){return!0};F.arr={};F.arr.each=function(array,func){if(!F.is.array(array)||!F.is.fn(func))return;for(var i=0,len=array.length;i<len;i++){if(func(array[i],i)===!1)break}};F.arr.get=function(array,where){var result=[];if(!F.is.array(array))return result;if(!F.is.fn(where))return array;for(var i=0,len=array.length;i<len;i++){if(where(array[i],i))result.push(array[i]);}
return result};F.arr.any=function(array,where){if(!F.is.array(array))return!1;where=F.is.fn(where)?where:returnTrue;for(var i=0,len=array.length;i<len;i++){if(where(array[i],i))return!0}
return!1};F.arr.contains=function(array,value){if(!F.is.array(array)||F.is.undef(value))return!1;for(var i=0,len=array.length;i<len;i++){if(array[i]==value)return!0}
return!1};F.arr.first=function(array,where){if(!F.is.array(array))return null;where=F.is.fn(where)?where:returnTrue;for(var i=0,len=array.length;i<len;i++){if(where(array[i],i))return array[i]}
return null};F.arr.map=function(array,getter){var result=[],returned=null;if(!F.is.array(array)||!F.is.fn(getter))return result;for(var i=0,len=array.length;i<len;i++){if((returned=getter(array[i],i))!=null)result.push(returned);}
return result};F.arr.remove=function(array,where){var remove=[],removed=[];if(!F.is.array(array)||!F.is.fn(where))return removed;var i=0,len=array.length;for(;i<len;i++){if(where(array[i],i,removed)){remove.push(i);removed.push(array[i])}}
remove.sort(function(a,b){return b-a});i=0;len=remove.length;for(;i<len;i++){var index=remove[i]-i;array.splice(index,1)}
return removed};F.arr.delete=function(array,item){var remove=-1,removed=null;if(!F.is.array(array)||F.is.undef(item))return removed;var i=0,len=array.length;for(;i<len;i++){if(array[i]==item){remove=i;removed=array[i];break}}
if(remove!=-1)array.splice(remove,1);return removed};F.arr.replace=function(array,oldItem,newItem){var index=array.indexOf(oldItem);if(index!==-1)array[index]=newItem}})(FooTable);(function(F){F.is={};F.is.type=function(value,type){return typeof value===type};F.is.defined=function(value){return typeof value!=='undefined'};F.is.undef=function(value){return typeof value==='undefined'};F.is.array=function(value){return'[object Array]'===Object.prototype.toString.call(value)};F.is.date=function(value){return'[object Date]'===Object.prototype.toString.call(value)&&!isNaN(value.getTime())};F.is.boolean=function(value){return'[object Boolean]'===Object.prototype.toString.call(value)};F.is.string=function(value){return'[object String]'===Object.prototype.toString.call(value)};F.is.number=function(value){return'[object Number]'===Object.prototype.toString.call(value)&&!isNaN(value)};F.is.fn=function(value){return(F.is.defined(window)&&value===window.alert)||'[object Function]'===Object.prototype.toString.call(value)};F.is.error=function(value){return'[object Error]'===Object.prototype.toString.call(value)};F.is.object=function(value){return'[object Object]'===Object.prototype.toString.call(value)};F.is.hash=function(value){return F.is.object(value)&&value.constructor===Object&&!value.nodeType&&!value.setInterval};F.is.element=function(obj){return typeof HTMLElement==='object'?obj instanceof HTMLElement:obj&&typeof obj==='object'&&obj!==null&&obj.nodeType===1&&typeof obj.nodeName==='string'};F.is.promise=function(obj){return F.is.object(obj)&&F.is.fn(obj.then)&&F.is.fn(obj.promise)};F.is.jq=function(obj){return F.is.defined(window.jQuery)&&obj instanceof jQuery&&obj.length>0};F.is.moment=function(obj){return F.is.defined(window.moment)&&F.is.object(obj)&&F.is.boolean(obj._isAMomentObject)};F.is.emptyObject=function(value){if(!F.is.hash(value))return!1;for(var prop in value){if(value.hasOwnProperty(prop))
return!1}
return!0};F.is.emptyArray=function(value){return F.is.array(value)?value.length===0:!0};F.is.emptyString=function(value){return F.is.string(value)?value.length===0:!0}})(FooTable);(function(F){F.str={};F.str.contains=function(str,contains,ignoreCase){if(F.is.emptyString(str)||F.is.emptyString(contains))return!1;return contains.length<=str.length&&(ignoreCase?str.toUpperCase().indexOf(contains.toUpperCase()):str.indexOf(contains))!==-1};F.str.containsExact=function(str,contains,ignoreCase){if(F.is.emptyString(str)||F.is.emptyString(contains)||contains.length>str.length)return!1;return new RegExp('\\b'+F.str.escapeRegExp(contains)+'\\b',ignoreCase?'i':'').test(str)};F.str.containsWord=function(str,word,ignoreCase){if(F.is.emptyString(str)||F.is.emptyString(word)||str.length<word.length)
return!1;var parts=str.split(/\W/);for(var i=0,len=parts.length;i<len;i++){if(ignoreCase?parts[i].toUpperCase()==word.toUpperCase():parts[i]==word)return!0}
return!1};F.str.from=function(str,from){if(F.is.emptyString(str))return str;return F.str.contains(str,from)?str.substring(str.indexOf(from)+1):str};F.str.startsWith=function(str,prefix){if(F.is.emptyString(str))return str==prefix;return str.slice(0,prefix.length)==prefix};F.str.toCamelCase=function(str){if(F.is.emptyString(str))return str;if(str.toUpperCase()===str)return str.toLowerCase();return str.replace(/^([A-Z])|[-\s_](\w)/g,function(match,p1,p2){if(F.is.string(p2))return p2.toUpperCase();return p1.toLowerCase()})};F.str.random=function(prefix){prefix=F.is.emptyString(prefix)?'':prefix;return prefix+Math.random().toString(36).substr(2,9)};F.str.escapeRegExp=function(str){if(F.is.emptyString(str))return str;return str.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}})(FooTable);(function(F){"use strict";if(!Object.create){Object.create=(function(){var Object=function(){};return function(prototype){if(arguments.length>1)
throw Error('Second argument not supported');if(!F.is.object(prototype))
throw TypeError('Argument must be an object');Object.prototype=prototype;var result=new Object();Object.prototype=null;return result}})()}
function Class(){}
var __extendable__=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;Class.__extend__=function(proto,name,func,original){proto[name]=F.is.fn(original)&&__extendable__.test(func)?(function(name,fn){return function(){var tmp,ret;tmp=this._super;this._super=original;ret=fn.apply(this,arguments);this._super=tmp;return ret}})(name,func):func};Class.extend=function(arg1,arg2){var args=Array.prototype.slice.call(arguments);arg1=args.shift();arg2=args.shift();function __extend__(proto,name,func,original){proto[name]=F.is.fn(original)&&__extendable__.test(func)?(function(name,fn,ofn){return function(){var tmp,ret;tmp=this._super;this._super=ofn;ret=fn.apply(this,arguments);this._super=tmp;return ret}})(name,func,original):func}
if(F.is.hash(arg1)){var proto=Object.create(this.prototype),_super=this.prototype;for(var name in arg1){if(name==='__ctor__')continue;__extend__(proto,name,arg1[name],_super[name])}
var obj=F.is.fn(proto.__ctor__)?proto.__ctor__:function(){if(!F.is.fn(this.construct))
throw new SyntaxError('FooTable class objects must be constructed with the "new" keyword.');this.construct.apply(this,arguments)};proto.construct=F.is.fn(proto.construct)?proto.construct:function(){};obj.prototype=proto;proto.constructor=obj;obj.extend=Class.extend;return obj}else if(F.is.string(arg1)&&F.is.fn(arg2)){__extend__(this.prototype,arg1,arg2,this.prototype[arg1])}};F.Class=Class;F.ClassFactory=F.Class.extend({construct:function(){this.registered={}},contains:function(name){return F.is.defined(this.registered[name])},names:function(){var names=[],name;for(name in this.registered){if(!this.registered.hasOwnProperty(name))continue;names.push(name)}
return names},register:function(name,klass,priority){if(!F.is.string(name)||!F.is.fn(klass))return;var current=this.registered[name];this.registered[name]={name:name,klass:klass,priority:F.is.number(priority)?priority:(F.is.defined(current)?current.priority:0)}},load:function(subs,arg1,argN){var self=this,args=Array.prototype.slice.call(arguments),reg=[],loaded=[],name,klass;subs=args.shift()||{};for(name in self.registered){if(!self.registered.hasOwnProperty(name))continue;var component=self.registered[name];if(subs.hasOwnProperty(name)){klass=subs[name];if(F.is.string(klass))klass=F.getFnPointer(subs[name]);if(F.is.fn(klass)){component={name:name,klass:klass,priority:self.registered[name].priority}}}
reg.push(component)}
for(name in subs){if(!subs.hasOwnProperty(name)||self.registered.hasOwnProperty(name))continue;klass=subs[name];if(F.is.string(klass))klass=F.getFnPointer(subs[name]);if(F.is.fn(klass)){reg.push({name:name,klass:klass,priority:0})}}
reg.sort(function(a,b){return b.priority-a.priority});F.arr.each(reg,function(r){if(F.is.fn(r.klass)){loaded.push(self._make(r.klass,args))}});return loaded},make:function(name,arg1,argN){var self=this,args=Array.prototype.slice.call(arguments),reg;name=args.shift();reg=self.registered[name];if(F.is.fn(reg.klass)){return self._make(reg.klass,args)}
return null},_make:function(klass,args){function Class(){return klass.apply(this,args)}
Class.prototype=klass.prototype;return new Class()}})})(FooTable);(function($,F){F.css2json=function(cssText){if(F.is.emptyString(cssText))return{};var json={},props=cssText.split(';'),pair,key,value;for(var i=0,i_len=props.length;i<i_len;i++){if(F.is.emptyString(props[i]))continue;pair=props[i].split(':');if(F.is.emptyString(pair[0])||F.is.emptyString(pair[1]))continue;key=F.str.toCamelCase(pair[0].trim());value=pair[1].trim();json[key]=value}
return json};F.getFnPointer=function(functionName){if(F.is.emptyString(functionName))return null;var pointer=window,parts=functionName.split('.');F.arr.each(parts,function(part){if(pointer[part])pointer=pointer[part]});return F.is.fn(pointer)?pointer:null};F.checkFnValue=function(self,value,def){def=F.is.fn(def)?def:null;function wrap(t,fn,d){if(!F.is.fn(fn))return d;return function(){return fn.apply(t,arguments)}}
return F.is.fn(value)?wrap(self,value,def):(F.is.type(value,'string')?wrap(self,F.getFnPointer(value),def):def)}})(jQuery,FooTable);(function($,F){F.Cell=F.Class.extend({construct:function(table,row,column,valueOrElement){this.ft=table;this.row=row;this.column=column;this.created=!1;this.define(valueOrElement)},define:function(valueOrElement){this.$el=F.is.element(valueOrElement)||F.is.jq(valueOrElement)?$(valueOrElement):null;this.$detail=null;var hasOptions=F.is.hash(valueOrElement)&&F.is.hash(valueOrElement.options)&&F.is.defined(valueOrElement.value);this.value=this.column.parser.call(this.column,F.is.jq(this.$el)?this.$el:(hasOptions?valueOrElement.value:valueOrElement),this.ft.o);this.o=$.extend(!0,{classes:null,style:null},hasOptions?valueOrElement.options:{});this.classes=F.is.jq(this.$el)&&this.$el.attr('class')?this.$el.attr('class').match(/\S+/g):(F.is.array(this.o.classes)?this.o.classes:(F.is.string(this.o.classes)?this.o.classes.match(/\S+/g):[]));this.style=F.is.jq(this.$el)&&this.$el.attr('style')?F.css2json(this.$el.attr('style')):(F.is.hash(this.o.style)?this.o.style:(F.is.string(this.o.style)?F.css2json(this.o.style):{}))},$create:function(){if(this.created)return;(this.$el=F.is.jq(this.$el)?this.$el:$('<td/>')).data('value',this.value).contents().detach().end().append(this.format(this.value));this._setClasses(this.$el);this._setStyle(this.$el);this.$detail=$('<tr/>').addClass(this.row.classes.join(' ')).data('__FooTableCell__',this).append($('<th/>')).append($('<td/>'));this.created=!0},collapse:function(){if(!this.created)return;this.$detail.children('th').html(this.column.title);this.$el.clone().attr('id',this.$el.attr('id')?this.$el.attr('id')+'-detail':undefined).css('display','table-cell').html('').append(this.$el.contents().detach()).replaceAll(this.$detail.children('td').first());if(!F.is.jq(this.$detail.parent()))
this.$detail.appendTo(this.row.$details.find('.footable-details > tbody'));},restore:function(){if(!this.created)return;if(F.is.jq(this.$detail.parent())){var $cell=this.$detail.children('td').first();this.$el.attr('class',$cell.attr('class')).attr('style',$cell.attr('style')).css('display',(this.column.hidden||!this.column.visible)?'none':'table-cell').append($cell.contents().detach())}
this.$detail.detach()},parse:function(){return this.column.parser.call(this.column,this.$el,this.ft.o)},format:function(value){return this.column.formatter.call(this.column,value,this.ft.o,this.row.value)},val:function(value,redraw,redrawSelf){if(F.is.undef(value)){return this.value}
var self=this,hasOptions=F.is.hash(value)&&F.is.hash(value.options)&&F.is.defined(value.value);this.o=$.extend(!0,{classes:self.classes,style:self.style},hasOptions?value.options:{});this.value=hasOptions?value.value:value;this.classes=F.is.array(this.o.classes)?this.o.classes:(F.is.string(this.o.classes)?this.o.classes.match(/\S+/g):[]);this.style=F.is.hash(this.o.style)?this.o.style:(F.is.string(this.o.style)?F.css2json(this.o.style):{});redrawSelf=F.is.boolean(redrawSelf)?redrawSelf:!0;if(this.created&&redrawSelf){this.$el.data('value',this.value).empty();var $detail=this.$detail.children('td').first().empty(),$target=F.is.jq(this.$detail.parent())?$detail:this.$el;$target.append(this.format(this.value));this._setClasses($target);this._setStyle($target);if(F.is.boolean(redraw)?redraw:!0)this.row.draw();}},_setClasses:function($el){var hasColClasses=!F.is.emptyArray(this.column.classes),hasClasses=!F.is.emptyArray(this.classes),classes=null;$el.removeAttr('class');if(!hasColClasses&&!hasClasses)return;if(hasColClasses&&hasClasses){classes=this.classes.concat(this.column.classes).join(' ')}else if(hasColClasses){classes=this.column.classes.join(' ')}else if(hasClasses){classes=this.classes.join(' ')}
if(!F.is.emptyString(classes)){$el.addClass(classes)}},_setStyle:function($el){var hasColStyle=!F.is.emptyObject(this.column.style),hasStyle=!F.is.emptyObject(this.style),style=null;$el.removeAttr('style');if(!hasColStyle&&!hasStyle)return;if(hasColStyle&&hasStyle){style=$.extend({},this.column.style,this.style)}else if(hasColStyle){style=this.column.style}else if(hasStyle){style=this.style}
if(F.is.hash(style)){$el.css(style)}}})})(jQuery,FooTable);(function($,F){F.Column=F.Class.extend({construct:function(instance,definition,type){this.ft=instance;this.type=F.is.emptyString(type)?'text':type;this.virtual=F.is.boolean(definition.virtual)?definition.virtual:!1;this.$el=F.is.jq(definition.$el)?definition.$el:null;this.index=F.is.number(definition.index)?definition.index:-1;this.internal=!1;this.define(definition);this.$create()},define:function(definition){this.hidden=F.is.boolean(definition.hidden)?definition.hidden:!1;this.visible=F.is.boolean(definition.visible)?definition.visible:!0;this.name=F.is.string(definition.name)?definition.name:null;if(this.name==null)this.name='col'+(definition.index+1);this.title=F.is.string(definition.title)?definition.title:null;if(!this.virtual&&this.title==null&&F.is.jq(this.$el))this.title=this.$el.html();if(this.title==null)this.title='Column '+(definition.index+1);this.style=F.is.hash(definition.style)?definition.style:(F.is.string(definition.style)?F.css2json(definition.style):{});this.classes=F.is.array(definition.classes)?definition.classes:(F.is.string(definition.classes)?definition.classes.match(/\S+/g):[]);this.parser=F.checkFnValue(this,definition.parser,this.parser);this.formatter=F.checkFnValue(this,definition.formatter,this.formatter)},$create:function(){(this.$el=!this.virtual&&F.is.jq(this.$el)?this.$el:$('<th/>')).html(this.title).addClass(this.classes.join(' ')).css(this.style)},parser:function(valueOrElement){if(F.is.element(valueOrElement)||F.is.jq(valueOrElement)){var data=$(valueOrElement).data('value');return F.is.defined(data)?data:$(valueOrElement).html()}
if(F.is.defined(valueOrElement)&&valueOrElement!=null)return valueOrElement+'';return null},formatter:function(value,options,rowData){return value==null?'':value},createCell:function(row){var element=F.is.jq(row.$el)?row.$el.children('td,th').get(this.index):null,data=F.is.hash(row.value)?row.value[this.name]:null;return new F.Cell(this.ft,row,this,element||data)}});F.columns=new F.ClassFactory();F.columns.register('text',F.Column)})(jQuery,FooTable);(function($,F){F.Component=F.Class.extend({construct:function(instance,enabled){if(!(instance instanceof F.Table))
throw new TypeError('The instance parameter must be an instance of FooTable.Table.');this.ft=instance;this.enabled=F.is.boolean(enabled)?enabled:!1},preinit:function(data){},init:function(){},destroy:function(){},predraw:function(){},draw:function(){},postdraw:function(){}});F.components=new F.ClassFactory()})(jQuery,FooTable);(function($,F){F.Defaults=function(){this.stopPropagation=!1;this.on=null};F.defaults=new F.Defaults()})(jQuery,FooTable);(function($,F){F.Row=F.Class.extend({construct:function(table,columns,dataOrElement){this.ft=table;this.columns=columns;this.created=!1;this.define(dataOrElement)},define:function(dataOrElement){this.$el=F.is.element(dataOrElement)||F.is.jq(dataOrElement)?$(dataOrElement):null;this.$toggle=$('<span/>',{'class':'footable-toggle fooicon fooicon-plus'});var isObj=F.is.hash(dataOrElement),hasOptions=isObj&&F.is.hash(dataOrElement.options)&&F.is.hash(dataOrElement.value);this.value=isObj?(hasOptions?dataOrElement.value:dataOrElement):null;this.o=$.extend(!0,{expanded:!1,classes:null,style:null},hasOptions?dataOrElement.options:{});this.expanded=F.is.jq(this.$el)?(this.$el.data('expanded')||this.o.expanded):this.o.expanded;this.classes=F.is.jq(this.$el)&&this.$el.attr('class')?this.$el.attr('class').match(/\S+/g):(F.is.array(this.o.classes)?this.o.classes:(F.is.string(this.o.classes)?this.o.classes.match(/\S+/g):[]));this.style=F.is.jq(this.$el)&&this.$el.attr('style')?F.css2json(this.$el.attr('style')):(F.is.hash(this.o.style)?this.o.style:(F.is.string(this.o.style)?F.css2json(this.o.style):{}));this.cells=this.createCells();var self=this;self.value={};F.arr.each(self.cells,function(cell){self.value[cell.column.name]=cell.val()})},$create:function(){if(this.created)return;(this.$el=F.is.jq(this.$el)?this.$el:$('<tr/>')).data('__FooTableRow__',this);this._setClasses(this.$el);this._setStyle(this.$el);if(this.ft.rows.toggleColumn=='last')this.$toggle.addClass('last-column');this.$details=$('<tr/>',{'class':'footable-detail-row'}).append($('<td/>',{colspan:this.ft.columns.visibleColspan}).append($('<table/>',{'class':'footable-details '+this.ft.classes.join(' ')}).append('<tbody/>')));var self=this;F.arr.each(self.cells,function(cell){if(!cell.created)cell.$create();self.$el.append(cell.$el)});self.$el.off('click.ft.row').on('click.ft.row',{self:self},self._onToggle);this.created=!0},createCells:function(){var self=this;return F.arr.map(self.columns,function(col){return col.createCell(self)})},val:function(data,redraw,redrawSelf){var self=this;if(!F.is.hash(data)){if(!F.is.hash(this.value)||F.is.emptyObject(this.value)){this.value={};F.arr.each(this.cells,function(cell){if(!cell.column.internal){self.value[cell.column.name]=cell.val()}})}
return this.value}
this.collapse(!1);var isObj=F.is.hash(data),hasOptions=isObj&&F.is.hash(data.options)&&F.is.hash(data.value);this.o=$.extend(!0,{expanded:self.expanded,classes:self.classes,style:self.style},hasOptions?data.options:{});this.expanded=this.o.expanded;this.classes=F.is.array(this.o.classes)?this.o.classes:(F.is.string(this.o.classes)?this.o.classes.match(/\S+/g):[]);this.style=F.is.hash(this.o.style)?this.o.style:(F.is.string(this.o.style)?F.css2json(this.o.style):{});if(isObj){if(hasOptions)data=data.value;if(F.is.hash(this.value)){for(var prop in data){if(!data.hasOwnProperty(prop))continue;this.value[prop]=data[prop]}}else{this.value=data}}else{this.value=null}
redrawSelf=F.is.boolean(redrawSelf)?redrawSelf:!0;F.arr.each(this.cells,function(cell){if(!cell.column.internal&&F.is.defined(self.value[cell.column.name])){cell.val(self.value[cell.column.name],!1,redrawSelf)}});if(this.created&&redrawSelf){this._setClasses(this.$el);this._setStyle(this.$el);if(F.is.boolean(redraw)?redraw:!0)this.draw();}},_setClasses:function($el){var hasClasses=!F.is.emptyArray(this.classes),classes=null;$el.removeAttr('class');if(!hasClasses)return;else classes=this.classes.join(' ');if(!F.is.emptyString(classes)){$el.addClass(classes)}},_setStyle:function($el){var hasStyle=!F.is.emptyObject(this.style),style=null;$el.removeAttr('style');if(!hasStyle)return;else style=this.style;if(F.is.hash(style)){$el.css(style)}},expand:function(){if(!this.created)return;var self=this;self.ft.raise('expand.ft.row',[self]).then(function(){self.__hidden__=F.arr.map(self.cells,function(cell){return cell.column.hidden&&cell.column.visible?cell:null});if(self.__hidden__.length>0){self.$details.insertAfter(self.$el).children('td').first().attr('colspan',self.ft.columns.visibleColspan);F.arr.each(self.__hidden__,function(cell){cell.collapse()})}
self.$el.attr('data-expanded',!0);self.$toggle.removeClass('fooicon-plus').addClass('fooicon-minus');self.expanded=!0;self.ft.raise('expanded.ft.row',[self])})},collapse:function(setExpanded){if(!this.created)return;var self=this;self.ft.raise('collapse.ft.row',[self]).then(function(){F.arr.each(self.__hidden__,function(cell){cell.restore()});self.$details.detach();self.$el.removeAttr('data-expanded');self.$toggle.removeClass('fooicon-minus').addClass('fooicon-plus');if(F.is.boolean(setExpanded)?setExpanded:!0)self.expanded=!1;self.ft.raise('collapsed.ft.row',[self])})},predraw:function(detach){if(this.created){if(this.expanded){this.collapse(!1)}
this.$toggle.detach();detach=F.is.boolean(detach)?detach:!0;if(detach)this.$el.detach();}},draw:function($parent){if(!this.created)this.$create();if(F.is.jq($parent))$parent.append(this.$el);var self=this;F.arr.each(self.cells,function(cell){cell.$el.css('display',(cell.column.hidden||!cell.column.visible?'none':'table-cell'));if(self.ft.rows.showToggle&&self.ft.columns.hasHidden){if((self.ft.rows.toggleColumn=='first'&&cell.column.index==self.ft.columns.firstVisibleIndex)||(self.ft.rows.toggleColumn=='last'&&cell.column.index==self.ft.columns.lastVisibleIndex)){cell.$el.prepend(self.$toggle)}}
cell.$el.add(cell.column.$el).removeClass('footable-first-visible footable-last-visible');if(cell.column.index==self.ft.columns.firstVisibleIndex){cell.$el.add(cell.column.$el).addClass('footable-first-visible')}
if(cell.column.index==self.ft.columns.lastVisibleIndex){cell.$el.add(cell.column.$el).addClass('footable-last-visible')}});if(this.expanded){this.expand()}},toggle:function(){if(this.created&&this.ft.columns.hasHidden){if(this.expanded)this.collapse();else this.expand()}},_onToggle:function(e){var self=e.data.self;if($(e.target).is(self.ft.rows.toggleSelector)){self.toggle()}}})})(jQuery,FooTable);(function($,F){F.instances=[];F.Table=F.Class.extend({construct:function(element,options,ready){this._resizeTimeout=null;this.id=F.instances.push(this);this.initialized=!1;this.$el=(F.is.jq(element)?element:$(element)).first();this.$loader=$('<div/>',{'class':'footable-loader'}).append($('<span/>',{'class':'fooicon fooicon-loader'}));this.o=$.extend(!0,{},F.defaults,options);this.data=this.$el.data()||{};this.classes=[];this.components=F.components.load((F.is.hash(this.data.components)?this.data.components:this.o.components),this);this.breakpoints=this.use(FooTable.Breakpoints);this.columns=this.use(FooTable.Columns);this.rows=this.use(FooTable.Rows);this._construct(ready)},_construct:function(ready){var self=this;return this._preinit().then(function(){return self._init().then(function(){return self.raise('ready.ft.table').then(function(){if(F.is.fn(ready))ready.call(self,self);})})}).always(function(arg){self.$el.show();if(F.is.error(arg)){console.error('FooTable: unhandled error thrown during initialization.',arg)}})},_preinit:function(){var self=this;return this.raise('preinit.ft.table',[self.data]).then(function(){var classes=(self.$el.attr('class')||'').match(/\S+/g)||[];self.o.ajax=F.checkFnValue(self,self.data.ajax,self.o.ajax);self.o.stopPropagation=F.is.boolean(self.data.stopPropagation)?self.data.stopPropagation:self.o.stopPropagation;for(var i=0,len=classes.length;i<len;i++){if(!F.str.startsWith(classes[i],'footable'))self.classes.push(classes[i]);}
self.$el.hide().after(self.$loader);return self.execute(!1,!1,'preinit',self.data)})},_init:function(){var self=this;return self.raise('init.ft.table').then(function(){var $thead=self.$el.children('thead'),$tbody=self.$el.children('tbody'),$tfoot=self.$el.children('tfoot');self.$el.addClass('footable footable-'+self.id);if(F.is.hash(self.o.on))self.$el.on(self.o.on);if($tfoot.length==0)self.$el.append($tfoot=$('<tfoot/>'));if($tbody.length==0)self.$el.append('<tbody/>');if($thead.length==0)self.$el.prepend($thead=$('<thead/>'));return self.execute(!1,!0,'init').then(function(){self.$el.data('__FooTable__',self);if($tfoot.children('tr').length==0)$tfoot.remove();if($thead.children('tr').length==0)$thead.remove();return self.raise('postinit.ft.table').then(function(){return self.draw()}).always(function(){$(window).off('resize.ft'+self.id,self._onWindowResize).on('resize.ft'+self.id,{self:self},self._onWindowResize);self.initialized=!0})})})},destroy:function(){var self=this;return self.raise('destroy.ft.table').then(function(){return self.execute(!0,!0,'destroy').then(function(){self.$el.removeData('__FooTable__').removeClass('footable-'+self.id);if(F.is.hash(self.o.on))self.$el.off(self.o.on);$(window).off('resize.ft'+self.id,self._onWindowResize);self.initialized=!1;F.instances[self.id]=null})}).fail(function(err){if(F.is.error(err)){console.error('FooTable: unhandled error thrown while destroying the plugin.',err)}})},raise:function(eventName,args){var self=this,debug=F.__debug__&&(F.is.emptyArray(F.__debug_options__.events)||F.arr.any(F.__debug_options__.events,function(name){return F.str.contains(eventName,name)}));args=args||[];args.unshift(this);return $.Deferred(function(d){var evt=$.Event(eventName);if(self.o.stopPropagation==!0){self.$el.one(eventName,function(e){e.stopPropagation()})}
if(debug)console.log('FooTable:'+eventName+': ',args);self.$el.trigger(evt,args);if(evt.isDefaultPrevented()){if(debug)console.log('FooTable: default prevented for the "'+eventName+'" event.');d.reject(evt)}else d.resolve(evt)})},use:function(type){for(var i=0,len=this.components.length;i<len;i++){if(this.components[i]instanceof type)return this.components[i]}
return null},draw:function(){var self=this;var $elCopy=self.$el.clone().insertBefore(self.$el);self.$el.detach();return self.execute(!1,!0,'predraw').then(function(){return self.raise('predraw.ft.table').then(function(){return self.execute(!1,!0,'draw').then(function(){return self.raise('draw.ft.table').then(function(){return self.execute(!1,!0,'postdraw').then(function(){return self.raise('postdraw.ft.table')})})})})}).fail(function(err){if(F.is.error(err)){console.error('FooTable: unhandled error thrown during a draw operation.',err)}}).always(function(){$elCopy.replaceWith(self.$el);self.$loader.remove()})},execute:function(reverse,enabled,methodName,param1,paramN){var self=this,args=Array.prototype.slice.call(arguments);reverse=args.shift();enabled=args.shift();var components=enabled?F.arr.get(self.components,function(c){return c.enabled}):self.components.slice(0);args.unshift(reverse?components.reverse():components);return self._execute.apply(self,args)},_execute:function(components,methodName,param1,paramN){if(!components||!components.length)return $.when();var self=this,args=Array.prototype.slice.call(arguments),component;components=args.shift();methodName=args.shift();component=components.shift();if(!F.is.fn(component[methodName]))
return self._execute.apply(self,[components,methodName].concat(args));return $.Deferred(function(d){try{var result=component[methodName].apply(component,args);if(F.is.promise(result)){return result.then(d.resolve,d.reject)}else{d.resolve(result)}}catch(err){d.reject(err)}}).then(function(){return self._execute.apply(self,[components,methodName].concat(args))})},_onWindowResize:function(e){var self=e.data.self;if(self._resizeTimeout!=null){clearTimeout(self._resizeTimeout)}
self._resizeTimeout=setTimeout(function(){self._resizeTimeout=null;self.raise('resize.ft.table').then(function(){self.breakpoints.check()})},300)}})})(jQuery,FooTable);(function($,F){F.ArrayColumn=F.Column.extend({construct:function(instance,definition){this._super(instance,definition,'array')},parser:function(valueOrElement){if(F.is.element(valueOrElement)||F.is.jq(valueOrElement)){var $el=$(valueOrElement),data=$el.data('value');if(F.is.array(data))return data;data=$el.html();try{data=JSON.parse(data)}catch(err){data=null}
return F.is.array(data)?data:null}
if(F.is.array(valueOrElement))return valueOrElement;return null},formatter:function(value,options,rowData){return F.is.array(value)?JSON.stringify(value):''}});F.columns.register('array',F.ArrayColumn)})(jQuery,FooTable);(function($,F){if(F.is.undef(window.moment)){return}
F.DateColumn=F.Column.extend({construct:function(instance,definition){this._super(instance,definition,'date');this.formatString=F.is.string(definition.formatString)?definition.formatString:'MM-DD-YYYY'},parser:function(valueOrElement){if(F.is.element(valueOrElement)||F.is.jq(valueOrElement)){var data=$(valueOrElement).data('value');valueOrElement=F.is.defined(data)?data:$(valueOrElement).text();if(F.is.string(valueOrElement))valueOrElement=isNaN(valueOrElement)?valueOrElement:+valueOrElement}
if(F.is.date(valueOrElement))return moment(valueOrElement);if(F.is.object(valueOrElement)&&F.is.boolean(valueOrElement._isAMomentObject))return valueOrElement;if(F.is.string(valueOrElement)){if(isNaN(valueOrElement)){return moment(valueOrElement,this.formatString)}else{valueOrElement=+valueOrElement}}
if(F.is.number(valueOrElement)){return moment(valueOrElement)}
return null},formatter:function(value,options,rowData){return F.is.object(value)&&F.is.boolean(value._isAMomentObject)&&value.isValid()?value.format(this.formatString):''},filterValue:function(valueOrElement){if(F.is.element(valueOrElement)||F.is.jq(valueOrElement))valueOrElement=$(valueOrElement).data('filterValue')||$(valueOrElement).text();if(F.is.hash(valueOrElement)&&F.is.hash(valueOrElement.options)){if(F.is.string(valueOrElement.options.filterValue))valueOrElement=valueOrElement.options.filterValue;if(F.is.defined(valueOrElement.value))valueOrElement=valueOrElement.value}
if(F.is.object(valueOrElement)&&F.is.boolean(valueOrElement._isAMomentObject))return valueOrElement.format(this.formatString);if(F.is.string(valueOrElement)){if(isNaN(valueOrElement)){return valueOrElement}else{valueOrElement=+valueOrElement}}
if(F.is.number(valueOrElement)||F.is.date(valueOrElement)){return moment(valueOrElement).format(this.formatString)}
if(F.is.defined(valueOrElement)&&valueOrElement!=null)return valueOrElement+'';return''}});F.columns.register('date',F.DateColumn)})(jQuery,FooTable);(function($,F){F.HTMLColumn=F.Column.extend({construct:function(instance,definition){this._super(instance,definition,'html')},parser:function(valueOrElement){if(F.is.string(valueOrElement))valueOrElement=$($.trim(valueOrElement));if(F.is.element(valueOrElement))valueOrElement=$(valueOrElement);if(F.is.jq(valueOrElement)){var tagName=valueOrElement.prop('tagName').toLowerCase();if(tagName=='td'||tagName=='th'){var data=valueOrElement.data('value');return F.is.defined(data)?data:valueOrElement.contents()}
return valueOrElement}
return null}});F.columns.register('html',F.HTMLColumn)})(jQuery,FooTable);(function($,F){F.NumberColumn=F.Column.extend({construct:function(instance,definition){this._super(instance,definition,'number');this.decimalSeparator=F.is.string(definition.decimalSeparator)?definition.decimalSeparator:'.';this.thousandSeparator=F.is.string(definition.thousandSeparator)?definition.thousandSeparator:',';this.decimalSeparatorRegex=new RegExp(F.str.escapeRegExp(this.decimalSeparator),'g');this.thousandSeparatorRegex=new RegExp(F.str.escapeRegExp(this.thousandSeparator),'g');this.cleanRegex=new RegExp('[^\-0-9'+F.str.escapeRegExp(this.decimalSeparator)+']','g')},parser:function(valueOrElement){if(F.is.element(valueOrElement)||F.is.jq(valueOrElement)){var data=$(valueOrElement).data('value');valueOrElement=F.is.defined(data)?data:$(valueOrElement).text().replace(this.cleanRegex,'')}
if(F.is.string(valueOrElement)){valueOrElement=valueOrElement.replace(this.thousandSeparatorRegex,'').replace(this.decimalSeparatorRegex,'.');valueOrElement=parseFloat(valueOrElement)}
if(F.is.number(valueOrElement))return valueOrElement;return null},formatter:function(value,options,rowData){if(value==null)return'';var s=(value+'').split('.');if(s.length==2&&s[0].length>3){s[0]=s[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,this.thousandSeparator)}
return s.join(this.decimalSeparator)}});F.columns.register('number',F.NumberColumn)})(jQuery,FooTable);(function($,F){F.ObjectColumn=F.Column.extend({construct:function(instance,definition){this._super(instance,definition,'object')},parser:function(valueOrElement){if(F.is.element(valueOrElement)||F.is.jq(valueOrElement)){var $el=$(valueOrElement),data=$el.data('value');if(F.is.object(data))return data;data=$el.html();try{data=JSON.parse(data)}catch(err){data=null}
return F.is.object(data)?data:null}
if(F.is.object(valueOrElement))return valueOrElement;return null},formatter:function(value,options,rowData){return F.is.object(value)?JSON.stringify(value):''}});F.columns.register('object',F.ObjectColumn)})(jQuery,FooTable);(function($,F){F.Breakpoint=F.Class.extend({construct:function(name,width){this.name=name;this.width=width}})})(jQuery,FooTable);(function($,F){F.Breakpoints=F.Component.extend({construct:function(table){this._super(table,!0);this.o=table.o;this.current=null;this.array=[];this.cascade=this.o.cascade;this.useParentWidth=this.o.useParentWidth;this.hidden=null;this._classNames='';this.getWidth=F.checkFnValue(this,this.o.getWidth,this.getWidth)},preinit:function(data){var self=this;return this.ft.raise('preinit.ft.breakpoints',[data]).then(function(){self.cascade=F.is.boolean(data.cascade)?data.cascade:self.cascade;self.o.breakpoints=F.is.hash(data.breakpoints)?data.breakpoints:self.o.breakpoints;self.getWidth=F.checkFnValue(self,data.getWidth,self.getWidth);if(self.o.breakpoints==null)self.o.breakpoints={"xs":480,"sm":768,"md":992,"lg":1200};for(var name in self.o.breakpoints){if(!self.o.breakpoints.hasOwnProperty(name))continue;self.array.push(new F.Breakpoint(name,self.o.breakpoints[name]));self._classNames+='breakpoint-'+name+' '}
self.array.sort(function(a,b){return b.width-a.width})})},init:function(){var self=this;return this.ft.raise('init.ft.breakpoints').then(function(){self.current=self.get()})},draw:function(){this.ft.$el.removeClass(this._classNames).addClass('breakpoint-'+this.current.name)},calculate:function(){var self=this,current=null,hidden=[],breakpoint,prev=null,width=self.getWidth();for(var i=0,len=self.array.length;i<len;i++){breakpoint=self.array[i];if((!current&&i==len-1)||(width>=breakpoint.width&&(prev instanceof F.Breakpoint?width<prev.width:!0))){current=breakpoint}
if(!current)hidden.push(breakpoint.name);prev=breakpoint}
hidden.push(current.name);self.hidden=hidden.join(' ');return current},visible:function(breakpoints){if(F.is.emptyString(breakpoints))return!0;if(breakpoints==='all')return!1;var parts=breakpoints.split(' '),i=0,len=parts.length;for(;i<len;i++){if(this.cascade?F.str.containsWord(this.hidden,parts[i]):parts[i]==this.current.name)return!1}
return!0},check:function(){var self=this,bp=self.get();if(!(bp instanceof F.Breakpoint)||bp==self.current)
return;self.ft.raise('before.ft.breakpoints',[self.current,bp]).then(function(){var previous=self.current;self.current=bp;return self.ft.draw().then(function(){self.ft.raise('after.ft.breakpoints',[self.current,previous])})})},get:function(breakpoint){if(F.is.undef(breakpoint))return this.calculate();if(breakpoint instanceof F.Breakpoint)return breakpoint;if(F.is.string(breakpoint))return F.arr.first(this.array,function(bp){return bp.name==breakpoint});if(F.is.number(breakpoint))return breakpoint>=0&&breakpoint<this.array.length?this.array[breakpoint]:null;return null},getWidth:function(){if(F.is.fn(this.o.getWidth))return this.o.getWidth(this.ft);if(this.useParentWidth==!0)return this.getParentWidth();return this.getViewportWidth()},getParentWidth:function(){return this.ft.$el.parent().width()},getViewportWidth:function(){return Math.max(document.documentElement.clientWidth,window.innerWidth,0)}});F.components.register('breakpoints',F.Breakpoints,1000)})(jQuery,FooTable);(function(F){F.Column.prototype.breakpoints=null;F.Column.prototype.__breakpoints_define__=function(definition){this.breakpoints=F.is.emptyString(definition.breakpoints)?null:definition.breakpoints};F.Column.extend('define',function(definition){this._super(definition);this.__breakpoints_define__(definition)})})(FooTable);(function(F){F.Defaults.prototype.breakpoints=null;F.Defaults.prototype.cascade=!1;F.Defaults.prototype.useParentWidth=!1;F.Defaults.prototype.getWidth=null})(FooTable);(function($,F){F.Columns=F.Component.extend({construct:function(table){this._super(table,!0);this.o=table.o;this.array=[];this.$header=null;this.showHeader=table.o.showHeader;this._fromHTML=F.is.emptyArray(table.o.columns)&&!F.is.promise(table.o.columns)},parse:function(data){var self=this;return $.Deferred(function(d){function merge(cols1,cols2){var merged=[];if(cols1.length==0||cols2.length==0){merged=cols1.concat(cols2)}else{var highest=0;F.arr.each(cols1.concat(cols2),function(c){if(c.index>highest)highest=c.index});highest++;for(var i=0,cols1_c,cols2_c;i<highest;i++){cols1_c={};F.arr.each(cols1,function(c){if(c.index==i){cols1_c=c;return!1}});cols2_c={};F.arr.each(cols2,function(c){if(c.index==i){cols2_c=c;return!1}});merged.push($.extend(!0,{},cols1_c,cols2_c))}}
return merged}
var json=[],html=[];var $header=self.ft.$el.find('tr.footable-header, thead > tr:last:has([data-breakpoints]), tbody > tr:first:has([data-breakpoints]), thead > tr:last, tbody > tr:first').first(),$cell,cdata;if($header.length>0){var virtual=$header.parent().is('tbody')&&$header.children().length==$header.children('td').length;if(!virtual)self.$header=$header.addClass('footable-header');$header.children('td,th').each(function(i,cell){$cell=$(cell);cdata=$cell.data();cdata.index=i;cdata.$el=$cell;cdata.virtual=virtual;html.push(cdata)});if(virtual)self.showHeader=!1}
if(F.is.array(self.o.columns)&&!F.is.emptyArray(self.o.columns)){F.arr.each(self.o.columns,function(c,i){c.index=i;json.push(c)});self.parseFinalize(d,merge(json,html))}else if(F.is.promise(self.o.columns)){self.o.columns.then(function(cols){F.arr.each(cols,function(c,i){c.index=i;json.push(c)});self.parseFinalize(d,merge(json,html))},function(xhr){d.reject(Error('Columns ajax request error: '+xhr.status+' ('+xhr.statusText+')'))})}else{self.parseFinalize(d,merge(json,html))}})},parseFinalize:function(deferred,cols){var self=this,columns=[],column;F.arr.each(cols,function(def){if(column=F.columns.contains(def.type)?F.columns.make(def.type,self.ft,def):new F.Column(self.ft,def))
columns.push(column);});if(F.is.emptyArray(columns)){deferred.reject(Error("No columns supplied."))}else{columns.sort(function(a,b){return a.index-b.index});deferred.resolve(columns)}},preinit:function(data){var self=this;return self.ft.raise('preinit.ft.columns',[data]).then(function(){return self.parse(data).then(function(columns){self.array=columns;self.showHeader=F.is.boolean(data.showHeader)?data.showHeader:self.showHeader})})},init:function(){var self=this;return this.ft.raise('init.ft.columns',[self.array]).then(function(){self.$create()})},destroy:function(){var self=this;this.ft.raise('destroy.ft.columns').then(function(){if(!self._fromHTML)self.$header.remove();})},predraw:function(){var self=this,first=!0;self.visibleColspan=0;self.firstVisibleIndex=0;self.lastVisibleIndex=0;self.hasHidden=!1;F.arr.each(self.array,function(col){col.hidden=!self.ft.breakpoints.visible(col.breakpoints);if(!col.hidden&&col.visible){if(first){self.firstVisibleIndex=col.index;first=!1}
self.lastVisibleIndex=col.index;self.visibleColspan++}
if(col.hidden)self.hasHidden=!0});self.ft.$el.toggleClass('breakpoint',self.hasHidden)},draw:function(){F.arr.each(this.array,function(col){col.$el.css('display',(col.hidden||!col.visible?'none':'table-cell'))});if(!this.showHeader&&F.is.jq(this.$header.parent())){this.$header.detach()}},$create:function(){var self=this;self.$header=F.is.jq(self.$header)?self.$header:$('<tr/>',{'class':'footable-header'});self.$header.children('th,td').detach();F.arr.each(self.array,function(col){self.$header.append(col.$el)});if(self.showHeader&&!F.is.jq(self.$header.parent())){self.ft.$el.children('thead').append(self.$header)}},get:function(column){if(column instanceof F.Column)return column;if(F.is.string(column))return F.arr.first(this.array,function(col){return col.name==column});if(F.is.number(column))return F.arr.first(this.array,function(col){return col.index==column});if(F.is.fn(column))return F.arr.get(this.array,column);return null},ensure:function(columns){var self=this,result=[];if(!F.is.array(columns))return result;F.arr.each(columns,function(name){result.push(self.get(name))});return result}});F.components.register('columns',F.Columns,900)})(jQuery,FooTable);(function(F){F.Defaults.prototype.columns=[];F.Defaults.prototype.showHeader=!0})(FooTable);(function($,F){F.Rows=F.Component.extend({construct:function(table){this._super(table,!0);this.o=table.o;this.array=[];this.all=[];this.showToggle=table.o.showToggle;this.toggleSelector=table.o.toggleSelector;this.toggleColumn=table.o.toggleColumn;this.emptyString=table.o.empty;this.expandFirst=table.o.expandFirst;this.expandAll=table.o.expandAll;this.$empty=null;this._fromHTML=F.is.emptyArray(table.o.rows)&&!F.is.promise(table.o.rows)},parse:function(){var self=this;return $.Deferred(function(d){var $rows=self.ft.$el.children('tbody').children('tr');if(F.is.array(self.o.rows)&&self.o.rows.length>0){self.parseFinalize(d,self.o.rows)}else if(F.is.promise(self.o.rows)){self.o.rows.then(function(rows){self.parseFinalize(d,rows)},function(xhr){d.reject(Error('Rows ajax request error: '+xhr.status+' ('+xhr.statusText+')'))})}else if(F.is.jq($rows)){self.parseFinalize(d,$rows);$rows.detach()}else{self.parseFinalize(d,[])}})},parseFinalize:function(deferred,rows){var self=this,result=$.map(rows,function(r){return new F.Row(self.ft,self.ft.columns.array,r)});deferred.resolve(result)},preinit:function(data){var self=this;return self.ft.raise('preinit.ft.rows',[data]).then(function(){return self.parse().then(function(rows){self.all=rows;self.array=self.all.slice(0);self.showToggle=F.is.boolean(data.showToggle)?data.showToggle:self.showToggle;self.toggleSelector=F.is.string(data.toggleSelector)?data.toggleSelector:self.toggleSelector;self.toggleColumn=F.is.string(data.toggleColumn)?data.toggleColumn:self.toggleColumn;if(self.toggleColumn!="first"&&self.toggleColumn!="last")self.toggleColumn="first";self.emptyString=F.is.string(data.empty)?data.empty:self.emptyString;self.expandFirst=F.is.boolean(data.expandFirst)?data.expandFirst:self.expandFirst;self.expandAll=F.is.boolean(data.expandAll)?data.expandAll:self.expandAll})})},init:function(){var self=this;return self.ft.raise('init.ft.rows',[self.all]).then(function(){self.$create()})},destroy:function(){var self=this;this.ft.raise('destroy.ft.rows').then(function(){F.arr.each(self.array,function(row){row.predraw(!self._fromHTML)});self.all=self.array=[]})},predraw:function(){F.arr.each(this.array,function(row){row.predraw()});this.array=this.all.slice(0)},$create:function(){this.$empty=$('<tr/>',{'class':'footable-empty'}).append($('<td/>').text(this.emptyString))},draw:function(){var self=this,$tbody=self.ft.$el.children('tbody'),first=!0;if(self.array.length>0){self.$empty.detach();F.arr.each(self.array,function(row){if((self.expandFirst&&first)||self.expandAll){row.expanded=!0;first=!1}
row.draw($tbody)})}else{self.$empty.children('td').attr('colspan',self.ft.columns.visibleColspan);$tbody.append(self.$empty)}},load:function(data,append){var self=this,rows=$.map(data,function(r){return new F.Row(self.ft,self.ft.columns.array,r)});F.arr.each(this.array,function(row){row.predraw()});this.all=(F.is.boolean(append)?append:!1)?this.all.concat(rows):rows;this.array=this.all.slice(0);this.ft.draw()},expand:function(){F.arr.each(this.array,function(row){row.expand()})},collapse:function(){F.arr.each(this.array,function(row){row.collapse()})}});F.components.register('rows',F.Rows,800)})(jQuery,FooTable);(function(F){F.Defaults.prototype.rows=[];F.Defaults.prototype.empty='No results';F.Defaults.prototype.showToggle=!0;F.Defaults.prototype.toggleSelector='tr,td,.footable-toggle';F.Defaults.prototype.toggleColumn='first';F.Defaults.prototype.expandFirst=!1;F.Defaults.prototype.expandAll=!1})(FooTable);(function(F){F.Table.prototype.loadRows=function(data,append){this.rows.load(data,append)}})(FooTable);(function(F){F.Filter=F.Class.extend({construct:function(name,query,columns,space,connectors,ignoreCase,hidden){this.name=name;this.space=F.is.string(space)&&(space=='OR'||space=='AND')?space:'AND';this.connectors=F.is.boolean(connectors)?connectors:!0;this.ignoreCase=F.is.boolean(ignoreCase)?ignoreCase:!0;this.hidden=F.is.boolean(hidden)?hidden:!1;this.query=query instanceof F.Query?query:new F.Query(query,this.space,this.connectors,this.ignoreCase);this.columns=columns},match:function(str){if(!F.is.string(str))return!1;if(F.is.string(this.query)){this.query=new F.Query(this.query,this.space,this.connectors,this.ignoreCase)}
return this.query instanceof F.Query?this.query.match(str):!1},matchRow:function(row){var self=this,text=F.arr.map(row.cells,function(cell){return F.arr.contains(self.columns,cell.column)?cell.filterValue:null}).join(' ');return self.match(text)}})})(FooTable);(function($,F){F.Filtering=F.Component.extend({construct:function(table){this._super(table,table.o.filtering.enabled);this.filters=table.o.filtering.filters;this.delay=table.o.filtering.delay;this.min=table.o.filtering.min;this.space=table.o.filtering.space;this.connectors=table.o.filtering.connectors;this.ignoreCase=table.o.filtering.ignoreCase;this.exactMatch=table.o.filtering.exactMatch;this.placeholder=table.o.filtering.placeholder;this.dropdownTitle=table.o.filtering.dropdownTitle;this.position=table.o.filtering.position;this.focus=table.o.filtering.focus;this.container=table.o.filtering.container;this.$container=null;this.$row=null;this.$cell=null;this.$form=null;this.$dropdown=null;this.$input=null;this.$button=null;this._filterTimeout=null;this._exactRegExp=/^"(.*?)"$/},preinit:function(data){var self=this;return self.ft.raise('preinit.ft.filtering').then(function(){if(self.ft.$el.hasClass('footable-filtering'))
self.enabled=!0;self.enabled=F.is.boolean(data.filtering)?data.filtering:self.enabled;if(!self.enabled)return;self.space=F.is.string(data.filterSpace)?data.filterSpace:self.space;self.min=F.is.number(data.filterMin)?data.filterMin:self.min;self.connectors=F.is.boolean(data.filterConnectors)?data.filterConnectors:self.connectors;self.ignoreCase=F.is.boolean(data.filterIgnoreCase)?data.filterIgnoreCase:self.ignoreCase;self.exactMatch=F.is.boolean(data.filterExactMatch)?data.filterExactMatch:self.exactMatch;self.focus=F.is.boolean(data.filterFocus)?data.filterFocus:self.focus;self.delay=F.is.number(data.filterDelay)?data.filterDelay:self.delay;self.placeholder=F.is.string(data.filterPlaceholder)?data.filterPlaceholder:self.placeholder;self.dropdownTitle=F.is.string(data.filterDropdownTitle)?data.filterDropdownTitle:self.dropdownTitle;self.container=F.is.string(data.filterContainer)?data.filterContainer:self.container;self.filters=F.is.array(data.filterFilters)?self.ensure(data.filterFilters):self.ensure(self.filters);if(self.ft.$el.hasClass('footable-filtering-left'))
self.position='left';if(self.ft.$el.hasClass('footable-filtering-center'))
self.position='center';if(self.ft.$el.hasClass('footable-filtering-right'))
self.position='right';self.position=F.is.string(data.filterPosition)?data.filterPosition:self.position},function(){self.enabled=!1})},init:function(){var self=this;return self.ft.raise('init.ft.filtering').then(function(){self.$create()},function(){self.enabled=!1})},destroy:function(){var self=this;return self.ft.raise('destroy.ft.filtering').then(function(){self.ft.$el.removeClass('footable-filtering').find('thead > tr.footable-filtering').remove()})},$create:function(){var self=this;var $form_grp=$('<div/>',{'class':'form-group footable-filtering-search'}).append($('<label/>',{'class':'sr-only',text:'Search'})),$input_grp=$('<div/>',{'class':'input-group'}).appendTo($form_grp),$input_grp_btn=$('<div/>',{'class':'input-group-btn'}),$dropdown_toggle=$('<button/>',{type:'button','class':'btn btn-default dropdown-toggle'}).on('click',{self:self},self._onDropdownToggleClicked).append($('<span/>',{'class':'caret'})),position;switch(self.position){case 'left':position='footable-filtering-left';break;case 'center':position='footable-filtering-center';break;default:position='footable-filtering-right';break}
self.ft.$el.addClass('footable-filtering').addClass(position);self.$container=self.container===null?$():$(self.container).first();if(!self.$container.length){self.$row=$('<tr/>',{'class':'footable-filtering'}).prependTo(self.ft.$el.children('thead'));self.$cell=$('<th/>').attr('colspan',self.ft.columns.visibleColspan).appendTo(self.$row);self.$container=self.$cell}else{self.$container.addClass('footable-filtering-external').addClass(position)}
self.$form=$('<form/>',{'class':'form-inline'}).append($form_grp).appendTo(self.$container);self.$input=$('<input/>',{type:'text','class':'form-control',placeholder:self.placeholder});self.$button=$('<button/>',{type:'button','class':'btn btn-primary'}).on('click',{self:self},self._onSearchButtonClicked).append($('<span/>',{'class':'fooicon fooicon-search'}));self.$dropdown=$('<ul/>',{'class':'dropdown-menu dropdown-menu-right'});if(!F.is.emptyString(self.dropdownTitle)){self.$dropdown.append($('<li/>',{'class':'dropdown-header','text':self.dropdownTitle}))}
self.$dropdown.append(F.arr.map(self.ft.columns.array,function(col){return col.filterable?$('<li/>').append($('<a/>',{'class':'checkbox'}).append($('<label/>',{html:col.title}).prepend($('<input/>',{type:'checkbox',checked:!0}).data('__FooTableColumn__',col)))):null}));if(self.delay>0){self.$input.on('keypress keyup paste',{self:self},self._onSearchInputChanged);self.$dropdown.on('click','input[type="checkbox"]',{self:self},self._onSearchColumnClicked)}
$input_grp_btn.append(self.$button,$dropdown_toggle,self.$dropdown);$input_grp.append(self.$input,$input_grp_btn)},predraw:function(){if(F.is.emptyArray(this.filters))
return;var self=this;self.ft.rows.array=$.grep(self.ft.rows.array,function(r){return r.filtered(self.filters)})},draw:function(){if(F.is.jq(this.$cell)){this.$cell.attr('colspan',this.ft.columns.visibleColspan)}
var search=this.find('search');if(search instanceof F.Filter){var query=search.query.val();if(this.exactMatch&&this._exactRegExp.test(query)){query=query.replace(this._exactRegExp,'$1')}
this.$input.val(query)}else{this.$input.val(null)}
this.setButton(!F.arr.any(this.filters,function(f){return!f.hidden}))},addFilter:function(nameOrFilter,query,columns,ignoreCase,connectors,space,hidden){var f=this.createFilter(nameOrFilter,query,columns,ignoreCase,connectors,space,hidden);if(f instanceof F.Filter){this.removeFilter(f.name);this.filters.push(f)}},removeFilter:function(name){F.arr.remove(this.filters,function(f){return f.name==name})},filter:function(focus){var self=this;self.filters=self.ensure(self.filters);return self.ft.raise('before.ft.filtering',[self.filters]).then(function(){self.filters=self.ensure(self.filters);if(focus){var start=self.$input.prop('selectionStart'),end=self.$input.prop('selectionEnd')}
return self.ft.draw().then(function(){if(focus){self.$input.focus().prop({selectionStart:start,selectionEnd:end})}
self.ft.raise('after.ft.filtering',[self.filters])})})},clear:function(){this.filters=F.arr.get(this.filters,function(f){return f.hidden});return this.filter(this.focus)},setButton:function(search){if(!search){this.$button.children('.fooicon').removeClass('fooicon-search').addClass('fooicon-remove')}else{this.$button.children('.fooicon').removeClass('fooicon-remove').addClass('fooicon-search')}},find:function(name){return F.arr.first(this.filters,function(f){return f.name==name})},columns:function(){if(F.is.jq(this.$dropdown)){return this.$dropdown.find('input:checked').map(function(){return $(this).data('__FooTableColumn__')}).get()}else{return this.ft.columns.get(function(c){return c.filterable})}},ensure:function(filters){var self=this,parsed=[],filterable=self.columns();if(!F.is.emptyArray(filters)){F.arr.each(filters,function(f){f=self._ensure(f,filterable);if(f instanceof F.Filter)parsed.push(f);})}
return parsed},createFilter:function(nameOrObject,query,columns,ignoreCase,connectors,space,hidden){if(F.is.string(nameOrObject)){nameOrObject={name:nameOrObject,query:query,columns:columns,ignoreCase:ignoreCase,connectors:connectors,space:space,hidden:hidden}}
return this._ensure(nameOrObject,this.columns())},_ensure:function(filter,selectedColumns){if((F.is.hash(filter)||filter instanceof F.Filter)&&!F.is.emptyString(filter.name)&&(!F.is.emptyString(filter.query)||filter.query instanceof F.Query)){filter.columns=F.is.emptyArray(filter.columns)?selectedColumns:this.ft.columns.ensure(filter.columns);filter.ignoreCase=F.is.boolean(filter.ignoreCase)?filter.ignoreCase:this.ignoreCase;filter.connectors=F.is.boolean(filter.connectors)?filter.connectors:this.connectors;filter.hidden=F.is.boolean(filter.hidden)?filter.hidden:!1;filter.space=F.is.string(filter.space)&&(filter.space==='AND'||filter.space==='OR')?filter.space:this.space;filter.query=F.is.string(filter.query)?new F.Query(filter.query,filter.space,filter.connectors,filter.ignoreCase):filter.query;return(filter instanceof F.Filter)?filter:new F.Filter(filter.name,filter.query,filter.columns,filter.space,filter.connectors,filter.ignoreCase,filter.hidden)}
return null},_onSearchInputChanged:function(e){var self=e.data.self;var alpha=e.type=='keypress'&&!F.is.emptyString(String.fromCharCode(e.charCode)),ctrl=e.type=='keyup'&&(e.which==8||e.which==46),paste=e.type=='paste';if(alpha||ctrl||paste){if(e.which==13)e.preventDefault();if(self._filterTimeout!=null)clearTimeout(self._filterTimeout);self._filterTimeout=setTimeout(function(){self._filterTimeout=null;var query=self.$input.val();if(query.length>=self.min){if(self.exactMatch&&!self._exactRegExp.test(query)){query='"'+query+'"'}
self.addFilter('search',query);self.filter(self.focus)}else if(F.is.emptyString(query)){self.clear()}},self.delay)}},_onSearchButtonClicked:function(e){e.preventDefault();var self=e.data.self;if(self._filterTimeout!=null)clearTimeout(self._filterTimeout);var $icon=self.$button.children('.fooicon');if($icon.hasClass('fooicon-remove'))self.clear();else{var query=self.$input.val();if(query.length>=self.min){if(self.exactMatch&&!self._exactRegExp.test(query)){query='"'+query+'"'}
self.addFilter('search',query);self.filter(self.focus)}}},_onSearchColumnClicked:function(e){var self=e.data.self;if(self._filterTimeout!=null)clearTimeout(self._filterTimeout);self._filterTimeout=setTimeout(function(){self._filterTimeout=null;var $icon=self.$button.children('.fooicon');if($icon.hasClass('fooicon-remove')){$icon.removeClass('fooicon-remove').addClass('fooicon-search');self.addFilter('search',self.$input.val());self.filter()}},self.delay)},_onDropdownToggleClicked:function(e){e.preventDefault();e.stopPropagation();var self=e.data.self;self.$dropdown.parent().toggleClass('open');if(self.$dropdown.parent().hasClass('open'))$(document).on('click.footable',{self:self},self._onDocumentClicked);else $(document).off('click.footable',self._onDocumentClicked)},_onDocumentClicked:function(e){if($(e.target).closest('.dropdown-menu').length==0){e.preventDefault();var self=e.data.self;self.$dropdown.parent().removeClass('open');$(document).off('click.footable',self._onDocumentClicked)}}});F.components.register('filtering',F.Filtering,500)})(jQuery,FooTable);(function(F){F.Query=F.Class.extend({construct:function(query,space,connectors,ignoreCase){this._original=null;this._value=null;this.space=F.is.string(space)&&(space=='OR'||space=='AND')?space:'AND';this.connectors=F.is.boolean(connectors)?connectors:!0;this.ignoreCase=F.is.boolean(ignoreCase)?ignoreCase:!0;this.left=null;this.right=null;this.parts=[];this.operator=null;this.val(query)},val:function(value){if(F.is.emptyString(value))return this._value;if(F.is.emptyString(this._original))this._original=value;else if(this._original==value)return;this._value=value;this._parse()},match:function(str){if(F.is.emptyString(this.operator)||this.operator==='OR')
return this._left(str,!1)||this._match(str,!1)||this._right(str,!1);if(this.operator==='AND')
return this._left(str,!0)&&this._match(str,!0)&&this._right(str,!0);},_match:function(str,def){var self=this,result=!1,empty=F.is.emptyString(str);if(F.is.emptyArray(self.parts)&&self.left instanceof F.Query)return def;if(F.is.emptyArray(self.parts))return result;if(self.space==='OR'){F.arr.each(self.parts,function(p){if(p.empty&&empty){result=!0;if(p.negate){result=!1;return result}}else{var match=(p.exact?F.str.containsExact:F.str.contains)(str,p.query,self.ignoreCase);if(match&&!p.negate)result=!0;if(match&&p.negate){result=!1;return result}}})}else{result=!0;F.arr.each(self.parts,function(p){if(p.empty){if((!empty&&!p.negate)||(empty&&p.negate))result=!1;return result}else{var match=(p.exact?F.str.containsExact:F.str.contains)(str,p.query,self.ignoreCase);if((!match&&!p.negate)||(match&&p.negate))result=!1;return result}})}
return result},_left:function(str,def){return(this.left instanceof F.Query)?this.left.match(str):def},_right:function(str,def){return(this.right instanceof F.Query)?this.right.match(str):def},_parse:function(){if(F.is.emptyString(this._value))return;if(/\sOR\s/.test(this._value)){this.operator='OR';var or=this._value.split(/(?:\sOR\s)(.*)?/);this.left=new F.Query(or[0],this.space,this.connectors,this.ignoreCase);this.right=new F.Query(or[1],this.space,this.connectors,this.ignoreCase)}else if(/\sAND\s/.test(this._value)){this.operator='AND';var and=this._value.split(/(?:\sAND\s)(.*)?/);this.left=new F.Query(and[0],this.space,this.connectors,this.ignoreCase);this.right=new F.Query(and[1],this.space,this.connectors,this.ignoreCase)}else{var self=this;this.parts=F.arr.map(this._value.match(/(?:[^\s"]+|"[^"]*")+/g),function(str){return self._part(str)})}},_part:function(str){var p={query:str,negate:!1,phrase:!1,exact:!1,empty:!1};if(F.str.startsWith(p.query,'-')){p.query=F.str.from(p.query,'-');p.negate=!0}
if(/^"(.*?)"$/.test(p.query)){p.query=p.query.replace(/^"(.*?)"$/,'$1');p.phrase=!0;p.exact=!0}else if(this.connectors&&/(?:\w)+?([-_\+\.])(?:\w)+?/.test(p.query)){p.query=p.query.replace(/(?:\w)+?([-_\+\.])(?:\w)+?/g,function(match,p1){return match.replace(p1,' ')});p.phrase=!0}
p.empty=p.phrase&&F.is.emptyString(p.query);return p}})})(FooTable);(function(F){F.Cell.prototype.filterValue=null;F.Cell.prototype.__filtering_define__=function(valueOrElement){this.filterValue=this.column.filterValue.call(this.column,valueOrElement)};F.Cell.prototype.__filtering_val__=function(value){if(F.is.defined(value)){this.filterValue=this.column.filterValue.call(this.column,value)}};F.Cell.extend('define',function(valueOrElement){this._super(valueOrElement);this.__filtering_define__(valueOrElement)});F.Cell.extend('val',function(value,redraw,redrawSelf){var val=this._super(value,redraw,redrawSelf);this.__filtering_val__(value);return val})})(FooTable);(function($,F){F.Column.prototype.filterable=!0;F.Column.prototype.filterValue=function(valueOrElement){if(F.is.element(valueOrElement)||F.is.jq(valueOrElement)){var data=$(valueOrElement).data('filterValue');return F.is.defined(data)?''+data:$(valueOrElement).text()}
if(F.is.hash(valueOrElement)&&F.is.hash(valueOrElement.options)){if(F.is.string(valueOrElement.options.filterValue))return valueOrElement.options.filterValue;if(F.is.defined(valueOrElement.value))valueOrElement=valueOrElement.value}
if(F.is.defined(valueOrElement)&&valueOrElement!=null)return valueOrElement+'';return''};F.Column.prototype.__filtering_define__=function(definition){this.filterable=F.is.boolean(definition.filterable)?definition.filterable:this.filterable;this.filterValue=F.checkFnValue(this,definition.filterValue,this.filterValue)};F.Column.extend('define',function(definition){this._super(definition);this.__filtering_define__(definition)})})(jQuery,FooTable);(function(F){F.Defaults.prototype.filtering={enabled:!1,filters:[],delay:1200,min:1,space:'AND',placeholder:'Search',dropdownTitle:null,position:'right',connectors:!0,ignoreCase:!0,exactMatch:!1,focus:!0,container:null}})(FooTable);(function(F){F.Row.prototype.filtered=function(filters){var result=!0,self=this;F.arr.each(filters,function(f){if((result=f.matchRow(self))==!1)return!1});return result}})(FooTable);(function($,F){F.Sorter=F.Class.extend({construct:function(column,direction){this.column=column;this.direction=direction}})})(jQuery,FooTable);(function($,F){F.Sorting=F.Component.extend({construct:function(table){this._super(table,table.o.sorting.enabled);this.o=table.o.sorting;this.column=null;this.allowed=!0;this.initial=null},preinit:function(data){var self=this;this.ft.raise('preinit.ft.sorting',[data]).then(function(){if(self.ft.$el.hasClass('footable-sorting'))
self.enabled=!0;self.enabled=F.is.boolean(data.sorting)?data.sorting:self.enabled;if(!self.enabled)return;self.column=F.arr.first(self.ft.columns.array,function(col){return col.sorted})},function(){self.enabled=!1})},init:function(){var self=this;this.ft.raise('init.ft.sorting').then(function(){if(!self.initial){var isset=!!self.column;self.initial={isset:isset,rows:self.ft.rows.all.slice(0),column:isset?self.column.name:null,direction:isset?self.column.direction:null}}
F.arr.each(self.ft.columns.array,function(col){if(col.sortable){col.$el.addClass('footable-sortable').append($('<span/>',{'class':'fooicon fooicon-sort'}))}});self.ft.$el.on('click.footable','.footable-sortable',{self:self},self._onSortClicked)},function(){self.enabled=!1})},destroy:function(){var self=this;this.ft.raise('destroy.ft.paging').then(function(){self.ft.$el.off('click.footable','.footable-sortable',self._onSortClicked);self.ft.$el.children('thead').children('tr.footable-header').children('.footable-sortable').removeClass('footable-sortable footable-asc footable-desc').find('span.fooicon').remove()})},predraw:function(){if(!this.column)return;var self=this,col=self.column;self.ft.rows.array.sort(function(a,b){return col.direction=='DESC'?col.sorter(b.cells[col.index].sortValue,a.cells[col.index].sortValue):col.sorter(a.cells[col.index].sortValue,b.cells[col.index].sortValue)})},draw:function(){if(!this.column)return;var self=this,$sortable=self.ft.$el.find('thead > tr > .footable-sortable'),$active=self.column.$el;$sortable.removeClass('footable-asc footable-desc').children('.fooicon').removeClass('fooicon-sort fooicon-sort-asc fooicon-sort-desc');$sortable.not($active).children('.fooicon').addClass('fooicon-sort');$active.addClass(self.column.direction=='DESC'?'footable-desc':'footable-asc').children('.fooicon').addClass(self.column.direction=='DESC'?'fooicon-sort-desc':'fooicon-sort-asc')},sort:function(column,direction){return this._sort(column,direction)},toggleAllowed:function(state){state=F.is.boolean(state)?state:!this.allowed;this.allowed=state;this.ft.$el.toggleClass('footable-sorting-disabled',!this.allowed)},hasChanged:function(){return!(!this.initial||!this.column||(this.column.name===this.initial.column&&(this.column.direction===this.initial.direction||(this.initial.direction===null&&this.column.direction==='ASC'))))},reset:function(){if(!!this.initial){if(this.initial.isset){this.sort(this.initial.column,this.initial.direction)}else{if(!!this.column){this.column.$el.removeClass('footable-asc footable-desc');this.column=null}
this.ft.rows.all=this.initial.rows;this.ft.draw()}}},_sort:function(column,direction){if(!this.allowed)return $.Deferred().reject('sorting disabled');var self=this;var sorter=new F.Sorter(self.ft.columns.get(column),F.Sorting.dir(direction));return self.ft.raise('before.ft.sorting',[sorter]).then(function(){F.arr.each(self.ft.columns.array,function(col){if(col!=self.column)col.direction=null});self.column=self.ft.columns.get(sorter.column);if(self.column)self.column.direction=F.Sorting.dir(sorter.direction);return self.ft.draw().then(function(){self.ft.raise('after.ft.sorting',[sorter])})})},_onSortClicked:function(e){var self=e.data.self,$header=$(this).closest('th,td'),direction=$header.is('.footable-asc, .footable-desc')?($header.hasClass('footable-desc')?'ASC':'DESC'):'ASC';self._sort($header.index(),direction)}});F.Sorting.dir=function(str){return F.is.string(str)&&(str=='ASC'||str=='DESC')?str:'ASC'};F.components.register('sorting',F.Sorting,600)})(jQuery,FooTable);(function(F){F.Cell.prototype.sortValue=null;F.Cell.prototype.__sorting_define__=function(valueOrElement){this.sortValue=this.column.sortValue.call(this.column,valueOrElement)};F.Cell.prototype.__sorting_val__=function(value){if(F.is.defined(value)){this.sortValue=this.column.sortValue.call(this.column,value)}};F.Cell.extend('define',function(valueOrElement){this._super(valueOrElement);this.__sorting_define__(valueOrElement)});F.Cell.extend('val',function(value,redraw,redrawSelf){var val=this._super(value,redraw,redrawSelf);this.__sorting_val__(value);return val})})(FooTable);(function($,F){F.Column.prototype.direction=null;F.Column.prototype.sortable=!0;F.Column.prototype.sorted=!1;F.Column.prototype.sorter=function(a,b){if(typeof a==='string')a=a.toLowerCase();if(typeof b==='string')b=b.toLowerCase();if(a===b)return 0;if(a<b)return-1;return 1};F.Column.prototype.sortValue=function(valueOrElement){if(F.is.element(valueOrElement)||F.is.jq(valueOrElement)){var data=$(valueOrElement).data('sortValue');return F.is.defined(data)?data:this.parser(valueOrElement)}
if(F.is.hash(valueOrElement)&&F.is.hash(valueOrElement.options)){if(F.is.string(valueOrElement.options.sortValue))return valueOrElement.options.sortValue;if(F.is.defined(valueOrElement.value))valueOrElement=valueOrElement.value}
if(F.is.defined(valueOrElement)&&valueOrElement!=null)return valueOrElement;return null};F.Column.prototype.__sorting_define__=function(definition){this.sorter=F.checkFnValue(this,definition.sorter,this.sorter);this.direction=F.is.type(definition.direction,'string')?F.Sorting.dir(definition.direction):null;this.sortable=F.is.boolean(definition.sortable)?definition.sortable:!0;this.sorted=F.is.boolean(definition.sorted)?definition.sorted:!1;this.sortValue=F.checkFnValue(this,definition.sortValue,this.sortValue)};F.Column.extend('define',function(definition){this._super(definition);this.__sorting_define__(definition)})})(jQuery,FooTable);(function(F){F.Defaults.prototype.sorting={enabled:!1}})(FooTable);(function($,F){F.HTMLColumn.extend('__sorting_define__',function(definition){this._super(definition);this.sortUse=F.is.string(definition.sortUse)&&$.inArray(definition.sortUse,['html','text'])!==-1?definition.sortUse:'html'});F.HTMLColumn.prototype.sortValue=function(valueOrElement){if(F.is.element(valueOrElement)||F.is.jq(valueOrElement)){var data=$(valueOrElement).data('sortValue');return F.is.defined(data)?data:this.parser(valueOrElement)}
if(F.is.hash(valueOrElement)&&F.is.hash(valueOrElement.options)){if(F.is.string(valueOrElement.options.sortValue))return valueOrElement.options.sortValue;if(F.is.defined(valueOrElement.value))valueOrElement=valueOrElement.value}
if(F.is.defined(valueOrElement)&&valueOrElement!=null)return valueOrElement;return null}})(jQuery,FooTable);(function($,F){F.NumberColumn.prototype.sortValue=function(valueOrElement){if(F.is.element(valueOrElement)||F.is.jq(valueOrElement)){var data=$(valueOrElement).data('sortValue');return F.is.number(data)?data:this.parser(valueOrElement)}
if(F.is.hash(valueOrElement)&&F.is.hash(valueOrElement.options)){if(F.is.string(valueOrElement.options.sortValue))return this.parser(valueOrElement);if(F.is.number(valueOrElement.options.sortValue))return valueOrElement.options.sortValue;if(F.is.number(valueOrElement.value))return valueOrElement.value}
if(F.is.string(valueOrElement))return this.parser(valueOrElement);if(F.is.number(valueOrElement))return valueOrElement;return null}})(jQuery,FooTable);(function(F){F.Table.prototype.sort=function(column,direction){return this.use(F.Sorting).sort(column,direction)}})(FooTable);(function($,F){F.Pager=F.Class.extend({construct:function(total,current,size,page,forward){this.total=total;this.current=current;this.size=size;this.page=page;this.forward=forward}})})(jQuery,FooTable);(function($,F){F.Paging=F.Component.extend({construct:function(table){this._super(table,table.o.paging.enabled);this.strings=table.o.paging.strings;this.current=table.o.paging.current;this.size=table.o.paging.size;this.limit=table.o.paging.limit;this.position=table.o.paging.position;this.countFormat=table.o.paging.countFormat;this.container=table.o.paging.container;this.total=-1;this.totalRows=0;this.previous=-1;this.formattedCount=null;this.$container=null;this.$wrapper=null;this.$row=null;this.$cell=null;this.$pagination=null;this.$count=null;this.detached=!0;this._createdLinks=0},preinit:function(data){var self=this;this.ft.raise('preinit.ft.paging',[data]).then(function(){if(self.ft.$el.hasClass('footable-paging'))
self.enabled=!0;self.enabled=F.is.boolean(data.paging)?data.paging:self.enabled;if(!self.enabled)return;self.size=F.is.number(data.pagingSize)?data.pagingSize:self.size;self.current=F.is.number(data.pagingCurrent)?data.pagingCurrent:self.current;self.limit=F.is.number(data.pagingLimit)?data.pagingLimit:self.limit;if(self.ft.$el.hasClass('footable-paging-left'))
self.position='left';if(self.ft.$el.hasClass('footable-paging-center'))
self.position='center';if(self.ft.$el.hasClass('footable-paging-right'))
self.position='right';self.position=F.is.string(data.pagingPosition)?data.pagingPosition:self.position;self.countFormat=F.is.string(data.pagingCountFormat)?data.pagingCountFormat:self.countFormat;self.container=F.is.string(data.pagingContainer)?data.pagingContainer:self.container;self.total=Math.ceil(self.ft.rows.all.length/self.size)},function(){self.enabled=!1})},init:function(){var self=this;this.ft.raise('init.ft.paging').then(function(){self.$create()},function(){self.enabled=!1})},destroy:function(){var self=this;this.ft.raise('destroy.ft.paging').then(function(){self.ft.$el.removeClass('footable-paging').find('tfoot > tr.footable-paging').remove();self.detached=!0;self._createdLinks=0})},predraw:function(){this.total=Math.ceil(this.ft.rows.array.length/this.size);this.current=this.current>this.total?this.total:(this.current<1?1:this.current);this.totalRows=this.ft.rows.array.length;if(this.totalRows>this.size){this.ft.rows.array=this.ft.rows.array.splice((this.current-1)*this.size,this.size)}
this.formattedCount=this.format(this.countFormat)},draw:function(){if(this.total<=1){if(!this.detached){if(this.$row){this.$row.detach()}else{this.$wrapper.detach()}
this.detached=!0}}else{if(this.detached){if(this.$row){var $tfoot=this.ft.$el.children('tfoot');if($tfoot.length==0){$tfoot=$('<tfoot/>');this.ft.$el.append($tfoot)}
this.$row.appendTo($tfoot)}else{this.$wrapper.appendTo(this.$container)}
this.detached=!1}
if(F.is.jq(this.$cell)){this.$cell.attr('colspan',this.ft.columns.visibleColspan)}
this._createLinks();this._setVisible(this.current,this.current>this.previous);this._setNavigation(!0);this.$count.text(this.formattedCount)}},$create:function(){this._createdLinks=0;var position='footable-paging-center';switch(this.position){case 'left':position='footable-paging-left';break;case 'right':position='footable-paging-right';break}
this.ft.$el.addClass('footable-paging').addClass(position);this.$container=this.container===null?null:$(this.container).first();if(!F.is.jq(this.$container)){var $tfoot=this.ft.$el.children('tfoot');if($tfoot.length==0){$tfoot=$('<tfoot/>');this.ft.$el.append($tfoot)}
this.$row=$('<tr/>',{'class':'footable-paging'}).prependTo($tfoot);this.$container=this.$cell=$('<td/>').attr('colspan',this.ft.columns.visibleColspan).appendTo(this.$row)}else{this.$container.addClass('footable-paging-external').addClass(position)}
this.$wrapper=$('<div/>',{'class':'footable-pagination-wrapper'}).appendTo(this.$container);this.$pagination=$('<ul/>',{'class':'pagination'}).on('click.footable','a.footable-page-link',{self:this},this._onPageClicked);this.$count=$('<span/>',{'class':'label label-default'});this.$wrapper.append(this.$pagination,$('<div/>',{'class':'divider'}),this.$count);this.detached=!1},format:function(formatString){var firstRow=(this.size*(this.current-1))+1,lastRow=this.size*this.current;if(this.ft.rows.array.length==0){firstRow=0;lastRow=0}else{lastRow=lastRow>this.totalRows?this.totalRows:lastRow}
return formatString.replace(/\{CP}/g,this.current).replace(/\{TP}/g,this.total).replace(/\{PF}/g,firstRow).replace(/\{PL}/g,lastRow).replace(/\{TR}/g,this.totalRows)},first:function(){return this._set(1)},prev:function(){return this._set(this.current-1>0?this.current-1:1)},next:function(){return this._set(this.current+1<this.total?this.current+1:this.total)},last:function(){return this._set(this.total)},goto:function(page){return this._set(page>this.total?this.total:(page<1?1:page))},prevPages:function(){var page=this.$pagination.children('li.footable-page.visible:first').data('page')-1;this._setVisible(page,!0);this._setNavigation(!1)},nextPages:function(){var page=this.$pagination.children('li.footable-page.visible:last').data('page')+1;this._setVisible(page,!1);this._setNavigation(!1)},pageSize:function(value){value=parseInt(value);if(isNaN(value)){return this.size}
this.size=value;this.total=Math.ceil(this.ft.rows.all.length/this.size);if(F.is.jq(this.$wrapper)){if(this.$container.is("td")){this.$row.remove()}else{this.$wrapper.remove()}}
this.$create();this.ft.draw()},_set:function(page){var self=this,pager=new F.Pager(self.total,self.current,self.size,page,page>self.current);return self.ft.raise('before.ft.paging',[pager]).then(function(){pager.page=pager.page>pager.total?pager.total:pager.page;pager.page=pager.page<1?1:pager.page;if(self.current==page)return $.when();self.previous=self.current;self.current=pager.page;return self.ft.draw().then(function(){self.ft.raise('after.ft.paging',[pager])})})},_createLinks:function(){if(this._createdLinks===this.total)return;var self=this,multiple=self.total>1,link=function(attr,html,klass){return $('<li/>',{'class':klass}).attr('data-page',attr).append($('<a/>',{'class':'footable-page-link',href:'#'}).data('page',attr).html(html))};self.$pagination.empty();if(multiple){self.$pagination.append(link('first',self.strings.first,'footable-page-nav'));self.$pagination.append(link('prev',self.strings.prev,'footable-page-nav'));if(self.limit>0&&self.limit<self.total){self.$pagination.append(link('prev-limit',self.strings.prevPages,'footable-page-nav'))}}
for(var i=0,$li;i<self.total;i++){$li=link(i+1,i+1,'footable-page');self.$pagination.append($li)}
if(multiple){if(self.limit>0&&self.limit<self.total){self.$pagination.append(link('next-limit',self.strings.nextPages,'footable-page-nav'))}
self.$pagination.append(link('next',self.strings.next,'footable-page-nav'));self.$pagination.append(link('last',self.strings.last,'footable-page-nav'))}
self._createdLinks=self.total},_setNavigation:function(active){if(this.current==1){this.$pagination.children('li[data-page="first"],li[data-page="prev"]').addClass('disabled')}else{this.$pagination.children('li[data-page="first"],li[data-page="prev"]').removeClass('disabled')}
if(this.current==this.total){this.$pagination.children('li[data-page="next"],li[data-page="last"]').addClass('disabled')}else{this.$pagination.children('li[data-page="next"],li[data-page="last"]').removeClass('disabled')}
if((this.$pagination.children('li.footable-page.visible:first').data('page')||1)==1){this.$pagination.children('li[data-page="prev-limit"]').addClass('disabled')}else{this.$pagination.children('li[data-page="prev-limit"]').removeClass('disabled')}
if((this.$pagination.children('li.footable-page.visible:last').data('page')||this.limit)==this.total){this.$pagination.children('li[data-page="next-limit"]').addClass('disabled')}else{this.$pagination.children('li[data-page="next-limit"]').removeClass('disabled')}
if(this.limit>0&&this.total<this.limit){this.$pagination.children('li[data-page="prev-limit"],li[data-page="next-limit"]').css('display','none')}else{this.$pagination.children('li[data-page="prev-limit"],li[data-page="next-limit"]').css('display','')}
if(active){this.$pagination.children('li.footable-page').removeClass('active').filter('li[data-page="'+this.current+'"]').addClass('active')}},_setVisible:function(page,right){if(this.limit>0&&this.total>this.limit){if(!this.$pagination.children('li.footable-page[data-page="'+page+'"]').hasClass('visible')){var start=0,end=0;if(right==!0){end=page>this.total?this.total:page;start=end-this.limit}else{start=page<1?0:page-1;end=start+this.limit}
if(start<0){start=0;end=this.limit>this.total?this.total:this.limit}
if(end>this.total){end=this.total;start=this.total-this.limit<0?0:this.total-this.limit}
this.$pagination.children('li.footable-page').removeClass('visible').slice(start,end).addClass('visible')}}else{this.$pagination.children('li.footable-page').removeClass('visible').slice(0,this.total).addClass('visible')}},_onPageClicked:function(e){e.preventDefault();if($(e.target).closest('li').is('.active,.disabled'))return;var self=e.data.self,page=$(this).data('page');switch(page){case 'first':self.first();return;case 'prev':self.prev();return;case 'next':self.next();return;case 'last':self.last();return;case 'prev-limit':self.prevPages();return;case 'next-limit':self.nextPages();return;default:self._set(page);return}}});F.components.register('paging',F.Paging,400)})(jQuery,FooTable);(function(F){F.Defaults.prototype.paging={enabled:!1,countFormat:'{CP} of {TP}',current:1,limit:5,position:'center',size:10,container:null,strings:{first:'&laquo;',prev:'&lsaquo;',next:'&rsaquo;',last:'&raquo;',prevPages:'...',nextPages:'...'}}})(FooTable);(function(F){F.Table.prototype.gotoPage=function(num){return this.use(F.Paging).goto(num)};F.Table.prototype.nextPage=function(){return this.use(F.Paging).next()};F.Table.prototype.prevPage=function(){return this.use(F.Paging).prev()};F.Table.prototype.firstPage=function(){return this.use(F.Paging).first()};F.Table.prototype.lastPage=function(){return this.use(F.Paging).last()};F.Table.prototype.nextPages=function(){return this.use(F.Paging).nextPages()};F.Table.prototype.prevPages=function(){return this.use(F.Paging).prevPages()};F.Table.prototype.pageSize=function(value){return this.use(F.Paging).pageSize(value)}})(FooTable);(function($,F){F.Editing=F.Component.extend({construct:function(table){this._super(table,table.o.editing.enabled);this.pageToNew=table.o.editing.pageToNew;this.alwaysShow=table.o.editing.alwaysShow;this.column=$.extend(!0,{},table.o.editing.column,{visible:this.alwaysShow});this.position=table.o.editing.position;this.showText=table.o.editing.showText;this.hideText=table.o.editing.hideText;this.addText=table.o.editing.addText;this.editText=table.o.editing.editText;this.deleteText=table.o.editing.deleteText;this.viewText=table.o.editing.viewText;this.allowAdd=table.o.editing.allowAdd;this.allowEdit=table.o.editing.allowEdit;this.allowDelete=table.o.editing.allowDelete;this.allowView=table.o.editing.allowView;this._$buttons=null;this.callbacks={addRow:F.checkFnValue(this,table.o.editing.addRow),editRow:F.checkFnValue(this,table.o.editing.editRow),deleteRow:F.checkFnValue(this,table.o.editing.deleteRow),viewRow:F.checkFnValue(this,table.o.editing.viewRow)}},preinit:function(data){var self=this;this.ft.raise('preinit.ft.editing',[data]).then(function(){if(self.ft.$el.hasClass('footable-editing'))
self.enabled=!0;self.enabled=F.is.boolean(data.editing)?data.editing:self.enabled;if(!self.enabled)return;self.pageToNew=F.is.boolean(data.editingPageToNew)?data.editingPageToNew:self.pageToNew;self.alwaysShow=F.is.boolean(data.editingAlwaysShow)?data.editingAlwaysShow:self.alwaysShow;self.position=F.is.string(data.editingPosition)?data.editingPosition:self.position;self.showText=F.is.string(data.editingShowText)?data.editingShowText:self.showText;self.hideText=F.is.string(data.editingHideText)?data.editingHideText:self.hideText;self.addText=F.is.string(data.editingAddText)?data.editingAddText:self.addText;self.editText=F.is.string(data.editingEditText)?data.editingEditText:self.editText;self.deleteText=F.is.string(data.editingDeleteText)?data.editingDeleteText:self.deleteText;self.viewText=F.is.string(data.editingViewText)?data.editingViewText:self.viewText;self.allowAdd=F.is.boolean(data.editingAllowAdd)?data.editingAllowAdd:self.allowAdd;self.allowEdit=F.is.boolean(data.editingAllowEdit)?data.editingAllowEdit:self.allowEdit;self.allowDelete=F.is.boolean(data.editingAllowDelete)?data.editingAllowDelete:self.allowDelete;self.allowView=F.is.boolean(data.editingAllowView)?data.editingAllowView:self.allowView;self.column=new F.EditingColumn(self.ft,self,$.extend(!0,{},self.column,data.editingColumn,{visible:self.alwaysShow}));if(self.ft.$el.hasClass('footable-editing-left'))
self.position='left';if(self.ft.$el.hasClass('footable-editing-right'))
self.position='right';if(self.position==='right'){self.column.index=self.ft.columns.array.length}else{self.column.index=0;for(var i=0,len=self.ft.columns.array.length;i<len;i++){self.ft.columns.array[i].index+=1}}
self.ft.columns.array.push(self.column);self.ft.columns.array.sort(function(a,b){return a.index-b.index});self.callbacks.addRow=F.checkFnValue(self,data.editingAddRow,self.callbacks.addRow);self.callbacks.editRow=F.checkFnValue(self,data.editingEditRow,self.callbacks.editRow);self.callbacks.deleteRow=F.checkFnValue(self,data.editingDeleteRow,self.callbacks.deleteRow);self.callbacks.viewRow=F.checkFnValue(self,data.editingViewRow,self.callbacks.viewRow)},function(){self.enabled=!1})},init:function(){var self=this;this.ft.raise('init.ft.editing').then(function(){self.$create()},function(){self.enabled=!1})},destroy:function(){var self=this;this.ft.raise('destroy.ft.editing').then(function(){self.ft.$el.removeClass('footable-editing footable-editing-always-show footable-editing-no-add footable-editing-no-edit footable-editing-no-delete footable-editing-no-view').off('click.ft.editing').find('tfoot > tr.footable-editing').remove()})},$create:function(){var self=this,position=self.position==='right'?'footable-editing-right':'footable-editing-left';self.ft.$el.addClass('footable-editing').addClass(position).on('click.ft.editing','.footable-show',{self:self},self._onShowClick).on('click.ft.editing','.footable-hide',{self:self},self._onHideClick).on('click.ft.editing','.footable-edit',{self:self},self._onEditClick).on('click.ft.editing','.footable-delete',{self:self},self._onDeleteClick).on('click.ft.editing','.footable-view',{self:self},self._onViewClick).on('click.ft.editing','.footable-add',{self:self},self._onAddClick);self.$cell=$('<td/>').attr('colspan',self.ft.columns.visibleColspan).append(self.$buttonShow());if(self.allowAdd){self.$cell.append(self.$buttonAdd())}
self.$cell.append(self.$buttonHide());if(self.alwaysShow){self.ft.$el.addClass('footable-editing-always-show')}
if(!self.allowAdd)self.ft.$el.addClass('footable-editing-no-add');if(!self.allowEdit)self.ft.$el.addClass('footable-editing-no-edit');if(!self.allowDelete)self.ft.$el.addClass('footable-editing-no-delete');if(!self.allowView)self.ft.$el.addClass('footable-editing-no-view');var $tfoot=self.ft.$el.children('tfoot');if($tfoot.length==0){$tfoot=$('<tfoot/>');self.ft.$el.append($tfoot)}
self.$row=$('<tr/>',{'class':'footable-editing'}).append(self.$cell).appendTo($tfoot)},$buttonShow:function(){return'<button type="button" class="btn btn-primary footable-show">'+this.showText+'</button>'},$buttonHide:function(){return'<button type="button" class="btn btn-default footable-hide">'+this.hideText+'</button>'},$buttonAdd:function(){return'<button type="button" class="btn btn-primary footable-add">'+this.addText+'</button> '},$buttonEdit:function(){return'<button type="button" class="btn btn-default footable-edit">'+this.editText+'</button> '},$buttonDelete:function(){return'<button type="button" class="btn btn-default footable-delete">'+this.deleteText+'</button>'},$buttonView:function(){return'<button type="button" class="btn btn-default footable-view">'+this.viewText+'</button> '},$rowButtons:function(){if(F.is.jq(this._$buttons))return this._$buttons.clone();this._$buttons=$('<div class="btn-group btn-group-xs" role="group"></div>');if(this.allowView)this._$buttons.append(this.$buttonView());if(this.allowEdit)this._$buttons.append(this.$buttonEdit());if(this.allowDelete)this._$buttons.append(this.$buttonDelete());return this._$buttons},draw:function(){this.$cell.attr('colspan',this.ft.columns.visibleColspan)},_onEditClick:function(e){e.preventDefault();var self=e.data.self,row=$(this).closest('tr').data('__FooTableRow__');if(row instanceof F.Row){self.ft.raise('edit.ft.editing',[row]).then(function(){self.callbacks.editRow.call(self.ft,row)})}},_onDeleteClick:function(e){e.preventDefault();var self=e.data.self,row=$(this).closest('tr').data('__FooTableRow__');if(row instanceof F.Row){self.ft.raise('delete.ft.editing',[row]).then(function(){self.callbacks.deleteRow.call(self.ft,row)})}},_onViewClick:function(e){e.preventDefault();var self=e.data.self,row=$(this).closest('tr').data('__FooTableRow__');if(row instanceof F.Row){self.ft.raise('view.ft.editing',[row]).then(function(){self.callbacks.viewRow.call(self.ft,row)})}},_onAddClick:function(e){e.preventDefault();var self=e.data.self;self.ft.raise('add.ft.editing').then(function(){self.callbacks.addRow.call(self.ft)})},_onShowClick:function(e){e.preventDefault();var self=e.data.self;self.ft.raise('show.ft.editing').then(function(){self.ft.$el.addClass('footable-editing-show');self.column.visible=!0;self.ft.draw()})},_onHideClick:function(e){e.preventDefault();var self=e.data.self;self.ft.raise('hide.ft.editing').then(function(){self.ft.$el.removeClass('footable-editing-show');self.column.visible=!1;self.ft.draw()})}});F.components.register('editing',F.Editing,850)})(jQuery,FooTable);(function($,F){F.EditingColumn=F.Column.extend({construct:function(instance,editing,definition){this._super(instance,definition,'editing');this.editing=editing;this.internal=!0},$create:function(){(this.$el=!this.virtual&&F.is.jq(this.$el)?this.$el:$('<th/>',{'class':'footable-editing'})).html(this.title)},parser:function(valueOrElement){if(F.is.string(valueOrElement))valueOrElement=$($.trim(valueOrElement));if(F.is.element(valueOrElement))valueOrElement=$(valueOrElement);if(F.is.jq(valueOrElement)){var tagName=valueOrElement.prop('tagName').toLowerCase();if(tagName=='td'||tagName=='th')return valueOrElement.data('value')||valueOrElement.contents();return valueOrElement}
return null},createCell:function(row){var $buttons=this.editing.$rowButtons(),$cell=$('<td/>').append($buttons);if(F.is.jq(row.$el)){if(this.index===0){$cell.prependTo(row.$el)}else{$cell.insertAfter(row.$el.children().eq(this.index-1))}}
return new F.Cell(this.ft,row,this,$cell||$cell.html())}});F.columns.register('editing',F.EditingColumn)})(jQuery,FooTable);(function($,F){F.Defaults.prototype.editing={enabled:!1,pageToNew:!0,position:'right',alwaysShow:!1,addRow:function(){},editRow:function(row){},deleteRow:function(row){},viewRow:function(row){},showText:'<span class="fooicon fooicon-pencil" aria-hidden="true"></span> Edit rows',hideText:'Cancel',addText:'New row',editText:'<span class="fooicon fooicon-pencil" aria-hidden="true"></span>',deleteText:'<span class="fooicon fooicon-trash" aria-hidden="true"></span>',viewText:'<span class="fooicon fooicon-stats" aria-hidden="true"></span>',allowAdd:!0,allowEdit:!0,allowDelete:!0,allowView:!1,column:{classes:'footable-editing',name:'editing',title:'',filterable:!1,sortable:!1}}})(jQuery,FooTable);(function($,F){if(F.is.defined(F.Paging)){F.Paging.prototype.unpaged=[];F.Paging.extend('predraw',function(){this.unpaged=this.ft.rows.array.slice(0);this._super()})}})(jQuery,FooTable);(function($,F){F.Row.prototype.add=function(redraw){redraw=F.is.boolean(redraw)?redraw:!0;var self=this;return $.Deferred(function(d){var index=self.ft.rows.all.push(self)-1;if(redraw){return self.ft.draw().then(function(){d.resolve(index)})}else{d.resolve(index)}})};F.Row.prototype.delete=function(redraw){redraw=F.is.boolean(redraw)?redraw:!0;var self=this;return $.Deferred(function(d){var index=self.ft.rows.all.indexOf(self);if(F.is.number(index)&&index>=0&&index<self.ft.rows.all.length){self.ft.rows.all.splice(index,1);if(redraw){return self.ft.draw().then(function(){d.resolve(self)})}}
d.resolve(self)})};if(F.is.defined(F.Paging)){F.Row.extend('add',function(redraw){redraw=F.is.boolean(redraw)?redraw:!0;var self=this,added=this._super(redraw),editing=self.ft.use(F.Editing),paging;if(editing&&editing.pageToNew&&(paging=self.ft.use(F.Paging))&&redraw){return added.then(function(){var index=paging.unpaged.indexOf(self);var page=Math.ceil((index+1)/paging.size);if(paging.current!==page){return paging.goto(page)}})}
return added})}
if(F.is.defined(F.Sorting)){F.Row.extend('val',function(data,redraw){redraw=F.is.boolean(redraw)?redraw:!0;var result=this._super(data);if(!F.is.hash(data)){return result}
var self=this;if(redraw){self.ft.draw().then(function(){var editing=self.ft.use(F.Editing),paging;if(F.is.defined(F.Paging)&&editing&&editing.pageToNew&&(paging=self.ft.use(F.Paging))){var index=paging.unpaged.indexOf(self);var page=Math.ceil((index+1)/paging.size);if(paging.current!==page){return paging.goto(page)}}})}
return result})}})(jQuery,FooTable);(function(F){F.Rows.prototype.add=function(dataOrRow,redraw){var row=dataOrRow;if(F.is.hash(dataOrRow)){row=new FooTable.Row(this.ft,this.ft.columns.array,dataOrRow)}
if(row instanceof FooTable.Row){row.add(redraw)}};F.Rows.prototype.update=function(indexOrRow,data,redraw){var len=this.ft.rows.all.length,row=indexOrRow;if(F.is.number(indexOrRow)&&indexOrRow>=0&&indexOrRow<len){row=this.ft.rows.all[indexOrRow]}
if(row instanceof FooTable.Row&&F.is.hash(data)){row.val(data,redraw)}};F.Rows.prototype.delete=function(indexOrRow,redraw){var len=this.ft.rows.all.length,row=indexOrRow;if(F.is.number(indexOrRow)&&indexOrRow>=0&&indexOrRow<len){row=this.ft.rows.all[indexOrRow]}
if(row instanceof FooTable.Row){row.delete(redraw)}}})(FooTable);(function($,F){var _uid=0,_url_hash=(function(str){var i,l,hval=0x811c9dc5;for(i=0,l=str.length;i<l;i++){hval^=str.charCodeAt(i);hval+=(hval<<1)+(hval<<4)+(hval<<7)+(hval<<8)+(hval<<24)}
return hval>>>0})(location.origin+location.pathname);F.State=F.Component.extend({construct:function(table){this._super(table,table.o.state.enabled);this._key='1';this.key=this._key+(F.is.string(table.o.state.key)?table.o.state.key:this._uid());this.filtering=F.is.boolean(table.o.state.filtering)?table.o.state.filtering:!0;this.paging=F.is.boolean(table.o.state.paging)?table.o.state.paging:!0;this.sorting=F.is.boolean(table.o.state.sorting)?table.o.state.sorting:!0},preinit:function(data){var self=this;this.ft.raise('preinit.ft.state',[data]).then(function(){self.enabled=F.is.boolean(data.state)?data.state:self.enabled;if(!self.enabled)return;self.key=self._key+(F.is.string(data.stateKey)?data.stateKey:self.key);self.filtering=F.is.boolean(data.stateFiltering)?data.stateFiltering:self.filtering;self.paging=F.is.boolean(data.statePaging)?data.statePaging:self.paging;self.sorting=F.is.boolean(data.stateSorting)?data.stateSorting:self.sorting},function(){self.enabled=!1})},get:function(key){return JSON.parse(localStorage.getItem(this.key+':'+key))},set:function(key,data){localStorage.setItem(this.key+':'+key,JSON.stringify(data))},remove:function(key){localStorage.removeItem(this.key+':'+key)},read:function(){this.ft.execute(!1,!0,'readState')},write:function(){this.ft.execute(!1,!0,'writeState')},clear:function(){this.ft.execute(!1,!0,'clearState')},_uid:function(){var id=this.ft.$el.attr('id');return _url_hash+'_'+(F.is.string(id)?id:++_uid)}});F.components.register('state',F.State,700)})(jQuery,FooTable);(function(F){F.Component.prototype.readState=function(){};F.Component.prototype.writeState=function(){};F.Component.prototype.clearState=function(){}})(FooTable);(function(F){F.Defaults.prototype.state={enabled:!1,filtering:!0,paging:!0,sorting:!0,key:null}})(FooTable);(function(F){if(!F.Filtering)return;F.Filtering.prototype.readState=function(){if(this.ft.state.filtering){var state=this.ft.state.get('filtering');if(F.is.hash(state)&&!F.is.emptyArray(state.filters)){this.filters=this.ensure(state.filters)}}};F.Filtering.prototype.writeState=function(){if(this.ft.state.filtering){var filters=F.arr.map(this.filters,function(f){return{name:f.name,query:f.query instanceof F.Query?f.query.val():f.query,columns:F.arr.map(f.columns,function(c){return c.name}),hidden:f.hidden,space:f.space,connectors:f.connectors,ignoreCase:f.ignoreCase}});this.ft.state.set('filtering',{filters:filters})}};F.Filtering.prototype.clearState=function(){if(this.ft.state.filtering){this.ft.state.remove('filtering')}}})(FooTable);(function(F){if(!F.Paging)return;F.Paging.prototype.readState=function(){if(this.ft.state.paging){var state=this.ft.state.get('paging');if(F.is.hash(state)){this.current=state.current;this.size=state.size}}};F.Paging.prototype.writeState=function(){if(this.ft.state.paging){this.ft.state.set('paging',{current:this.current,size:this.size})}};F.Paging.prototype.clearState=function(){if(this.ft.state.paging){this.ft.state.remove('paging')}}})(FooTable);(function(F){if(!F.Sorting)return;F.Sorting.prototype.readState=function(){if(this.ft.state.sorting){var state=this.ft.state.get('sorting');if(F.is.hash(state)){var column=this.ft.columns.get(state.column);if(column instanceof F.Column){this.column=column;this.column.direction=state.direction}}}};F.Sorting.prototype.writeState=function(){if(this.ft.state.sorting&&this.column instanceof F.Column){this.ft.state.set('sorting',{column:this.column.name,direction:this.column.direction})}};F.Sorting.prototype.clearState=function(){if(this.ft.state.sorting){this.ft.state.remove('sorting')}}})(FooTable);(function(F){F.Table.extend('_construct',function(ready){this.state=this.use(FooTable.State);return this._super(ready)});F.Table.extend('_preinit',function(){var self=this;return self._super().then(function(){if(self.state.enabled){self.state.read()}})});F.Table.extend('draw',function(){var self=this;return self._super().then(function(){if(self.state.enabled){self.state.write()}})})})(FooTable);(function($,F){F.Export=F.Component.extend({construct:function(table){this._super(table,!0);this.snapshot=[]},predraw:function(){this.snapshot=this.ft.rows.array.slice(0)},columns:function(){var result=[];F.arr.each(this.ft.columns.array,function(column){if(!column.internal){result.push({type:column.type,name:column.name,title:column.title,visible:column.visible,hidden:column.hidden,classes:column.classes,style:column.style})}});return result},rows:function(filtered){filtered=F.is.boolean(filtered)?filtered:!1;var rows=filtered?this.ft.rows.all:this.snapshot,result=[];F.arr.each(rows,function(row){result.push(row.val())});return result},json:function(filtered){return JSON.parse(JSON.stringify({columns:this.columns(),rows:this.rows(filtered)}))},csv:function(filtered){var csv="",columns=this.columns(),value,escaped;F.arr.each(columns,function(column,i){escaped='"'+column.title.replace(/"/g,'""')+'"';csv+=(i===0?escaped:","+escaped)});csv+="\n";var rows=filtered?this.ft.rows.all:this.snapshot;F.arr.each(rows,function(row){F.arr.each(row.cells,function(cell,i){if(!cell.column.internal){value=cell.column.stringify.call(cell.column,cell.value,cell.ft.o,cell.row.value);escaped='"'+value.replace(/"/g,'""')+'"';csv+=(i===0?escaped:","+escaped)}});csv+="\n"});return csv}});F.components.register("export",F.Export,490)})(jQuery,FooTable);(function(F){F.Column.prototype.__export_define__=function(definition){this.stringify=F.checkFnValue(this,definition.stringify,this.stringify)};F.Column.extend('define',function(definition){this._super(definition);this.__export_define__(definition)});F.Column.prototype.stringify=function(value,options,rowData){return value+""};F.DateColumn.prototype.stringify=function(value,options,rowData){return F.is.object(value)&&F.is.boolean(value._isAMomentObject)&&value.isValid()?value.format(this.formatString):''};F.ObjectColumn.prototype.stringify=function(value,options,rowData){return F.is.object(value)?JSON.stringify(value):""};F.ArrayColumn.prototype.stringify=function(value,options,rowData){return F.is.array(value)?JSON.stringify(value):""}})(FooTable);(function(F){F.Table.prototype.toJSON=function(filtered){return this.use(F.Export).json(filtered)};F.Table.prototype.toCSV=function(filtered){return this.use(F.Export).csv(filtered)}})(FooTable)