<?php
	$id = ' id="' . $this->zoneconfig['conf']['id'] . '"';
	$melisKey = 'data-melisKey="'.$this->zoneconfig['conf']['melisKey'].'"';
?>

<div class="melis-core-dashboard-dnd-box" <?= $melisKey.' '.$id; ?>>
    <div class="melis-core-dashboard-dnd-fix-menu">
        <div class="melis-core-dashboard-dnd-title"><?php echo $this->translate('tr_melisore_Plugins')?></div>
        <div class="melis-core-dashboard-plugin-filter-box">
            <?php foreach ($this->plugins as $moduleSection => $modules){ ?>
                <?php
                    $sectionChildrenCtr = count($modules);
                ?>
                <?php if ($sectionChildrenCtr > 0) { // the section will only visible if there is a module under?>
                    <div class="melis-core-dashboard-ps-box">
                          <span class="melis-core-dashboard-filter-btn">
                                 <div class="pull-left melis-logo" data-dash-icon="fa-tachometer" data-dash-name="MelisCore" data-dash-id="id_meliscore_toolstree_section_dashboard" style="margin-top: -2px;margin-right:9px;">
                                    <svg class="melis-icon" style="width:30px;height:30px;" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 30 30" enable-background="new 0 0 30 30" xml:space="preserve">
                                    <?php  if ($moduleSection == 'MelisCore') {?>
                                            <g>
                                                <rect class="bg-color" y="0.1" fill="#ee6622" width="30" height="30"></rect>
                                                <rect class="light-color" x="14.6" y="2.7" fill="#f7962d" width="12.7" height="24.6"></rect>
                                                <g>
                                                    <path fill="#FFFFFF" d="M7.4,21.1V9.5H22v11.7h-2.9v-8.8h-2.9v8.8h-2.9v-8.8h-2.9v8.8H7.4z"></path>
                                                </g>
                                            </g>
                                    <?php } else if ( $moduleSection == 'MelisCms') { ?>
                                            <g>
                                                 <rect class="bg-color" y="0.1" fill="#69b344" width="30" height="30"></rect>
                                                 <rect class="light-color" x="14.6" y="2.7" fill="#85c555" width="12.7" height="24.6"></rect>
                                                 <g>
                                                    <path fill="#FFFFFF" d="M7.4,21.1V9.5H22v11.7h-2.9v-8.8h-2.9v8.8h-2.9v-8.8h-2.9v8.8H7.4z"></path>
                                                 </g>
                                            </g>
                                    <?php } else if ( $moduleSection == "MelisMarketing") {?>
                                            <g>
                                             <rect class="bg-color" y="0.1" fill="#70469c" width="30" height="30"></rect>
                                             <rect class="light-color" x="14.6" y="2.7" fill="#8965ad" width="12.7" height="24.6"></rect>
                                             <g>
                                                <path fill="#FFFFFF" d="M7.4,21.1V9.5H22v11.7h-2.9v-8.8h-2.9v8.8h-2.9v-8.8h-2.9v8.8H7.4z"></path>
                                             </g>
                                          </g>
                                    <?php } else if ( $moduleSection == 'MelisCommerce') {?>
                                            <g>
                                             <rect class="bg-color" y="0.1" fill="#3997d4" width="30" height="30"></rect>
                                             <rect class="light-color" x="14.6" y="2.7" fill="#2780c4" width="12.7" height="24.6"></rect>
                                             <g>
                                                <path fill="#FFFFFF" d="M7.4,21.1V9.5H22v11.7h-2.9v-8.8h-2.9v8.8h-2.9v-8.8h-2.9v8.8H7.4z"></path>
                                             </g>
                                          </g>
                                    <?php } else if ( $moduleSection == "CustomProjects") { ?>
                                            <g>
                                             <rect class="bg-color" y="0.1" fill="#676767" width="30" height="30"></rect>
                                             <rect class="light-color" x="14.6" y="2.7" fill="#777777" width="12.7" height="24.6"></rect>
                                             <g>
                                                <path fill="#FFFFFF" d="M7.4,21.1V9.5H22v11.7h-2.9v-8.8h-2.9v8.8h-2.9v-8.8h-2.9v8.8H7.4z"></path>
                                             </g>
                                          </g>
                                    <?php } else {?>
                                            <g>
                                             <rect class="bg-color" y="0.1" fill="#C52127" width="30" height="30"></rect>
                                             <rect class="light-color" x="14.6" y="2.7" fill="#E71E26" width="12.7" height="24.6"></rect>
                                             <g>
                                                <path fill="#FFFFFF" d="M7.4,21.1V9.5H22v11.7h-2.9v-8.8h-2.9v8.8h-2.9v-8.8h-2.9v8.8H7.4z"></path>
                                             </g>
                                          </g>
                                    <?php }?>
                                </svg>
                            </div>
                          <?= $moduleSection ?>
                          <i class="fa fa-angle-down"></i>
                        </span>
                        <div class="melis-core-dashboard-plugin-snippets-box">
                            <?php foreach ($modules as $moduleName => $plugins){ ?>
                                <?php
                                    // one special rule
                                    // if there's only one subsection then
                                    // dont rewrite the module name and just list plugins
                                    if ($sectionChildrenCtr > 1) { ?>
                                        <div class="melis-core-category-box">
                                            <span class="melis-core-dashboard-category-btn"><?= $this->translate('tr_PluginSection_' .$moduleName); ?> <i class="fa fa-angle-down"></i></span>
                                            <div class="melis-core-dashboard-category-plugins-box">
                                                <?php foreach ($plugins as $pluginName => $conf) { ?>
                                                    <div class="melis-core-dashboard-plugin-snippets" title="<?php echo $this->translate($conf['description'])?>">
                                                        <div class="hidden plugin-json-config"><?php echo json_encode($conf) ?></div>
                                                        <img src="<?php echo $conf['thumbnail']?>" alt="">
                                                        <span class="melis-core-dashboard-plugin-title"><?php echo $this->translate($conf['name'])?></span>
                                                    </div>
                                                <?php }?>
                                            </div>
                                        </div>
                                <?php } else {?>
                                        <?php foreach ($plugins as $pluginName => $conf) { ?>
                                            <div class="melis-core-dashboard-plugin-snippets" title="<?php echo $this->translate($conf['description'])?>">
                                                <div class="hidden plugin-json-config"><?php echo json_encode($conf) ?></div>
                                                <img src="<?php echo $conf['thumbnail']?>" alt="">
                                                <span class="melis-core-dashboard-plugin-title"><?php echo $this->translate($conf['name'])?></span>
                                            </div>
                                        <?php }?>
                                <?php }?>
                            <?php } ?>
                        </div>
                    </div>
                <?php }?>
            <?php }?>
        </div>
        <div class="melis-core-dashboard-plugin-delete-all">
            <button class='btn btn-primary btn-md' id='dashboard-plugin-delete-all'><?= $this->translate('tr_melisore_remove_all_plugins');?></button>
        </div>
    </div>
    <div id="melisDashBoardPluginBtn" title="Dashboard Plugins">
        <span class="melis-dashboard-new-plugin hidden">NEW</span>
        <i class="fa fa-plug fa-lg"></i>
    </div>
</div>